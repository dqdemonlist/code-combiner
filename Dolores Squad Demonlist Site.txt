–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: demonlist-manager.py
import tkinter as tk
from tkinter import ttk, messagebox, scrolledtext
import json
import re
from datetime import datetime
import os

class DemonlistGUI:
    def __init__(self, root):
        self.root = root
        self.root.title("üéÆ Dolores Squad Demonlist Manager")
        self.root.geometry("1200x800")
        self.root.configure(bg='#1a1a1a')
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫
        self.beating_demon = None
        self.beating_player = None
        self.beating_progress = None
        self.beating_date = None
        
        # –§–∞–π–ª—ã
        self.demons_file = "js/demons.js"
        self.players_file = "js/players.js"
        self.future_demons_file = "js/futuredemons.js"
        self.list_file = "js/list.js"
        
        self.setup_styles()
        self.create_widgets()
        self.load_data()
        
    def setup_styles(self):
        self.style = ttk.Style()
        
        # –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–µ–º–Ω–∞—è —Ç–µ–º–∞
        self.style.configure('TFrame', background='#1a1a1a')
        self.style.configure('TLabel', background='#1a1a1a', foreground='#ffffff', font=('Segoe UI', 10))
        self.style.configure('TButton', font=('Segoe UI', 10), padding=8)
        self.style.configure('TNotebook', background='#1a1a1a')
        self.style.configure('TNotebook.Tab', 
                           background='#2d2d2d', 
                           foreground='#ffffff',
                           padding=[15, 5],
                           font=('Segoe UI', 9, 'bold'))
        self.style.map('TNotebook.Tab', 
                      background=[('selected', '#4a4a4a')],
                      foreground=[('selected', '#ff6b6b')])
        
        self.style.configure('Title.TLabel', font=('Segoe UI', 16, 'bold'), foreground='#ff6b6b')
        self.style.configure('Subtitle.TLabel', font=('Segoe UI', 12, 'bold'), foreground='#6bc5ff')
        self.style.configure('Accent.TButton', background='#ff6b6b', foreground='white')
        self.style.configure('Danger.TButton', background='#dc3545', foreground='white')
        self.style.configure('Success.TButton', background='#28a745', foreground='white')
        
    def create_widgets(self):
        # –ì–ª–∞–≤–Ω—ã–π —Ñ—Ä–µ–π–º
        main_frame = ttk.Frame(self.root)
        main_frame.pack(fill='both', expand=True, padx=15, pady=15)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ttk.Label(main_frame, text="üî• DOLORES SQUAD DEMONLIST MANAGER", style='Title.TLabel')
        title_label.pack(pady=(0, 20))
        
        # –°–æ–∑–¥–∞–µ–º notebook –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
        notebook = ttk.Notebook(main_frame)
        notebook.pack(fill='both', expand=True)
        
        # –í–∫–ª–∞–¥–∫–∏
        self.create_view_tab(notebook)
        self.create_demon_tab(notebook)
        self.create_player_tab(notebook)
        self.create_future_tab(notebook)
        self.create_completion_tab(notebook)
        self.create_calculator_tab(notebook)
        self.create_ranking_tab(notebook)
        self.create_code_editor_tab(notebook)
        self.create_delete_tab(notebook)
        
    def create_view_tab(self, notebook):
        view_frame = ttk.Frame(notebook)
        notebook.add(view_frame, text="üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö")
        
        # –°–æ–∑–¥–∞–µ–º notebook –≤–Ω—É—Ç—Ä–∏ –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
        view_notebook = ttk.Notebook(view_frame)
        view_notebook.pack(fill='both', expand=True, padx=10, pady=10)
        
        # –î–µ–º–æ–Ω—ã
        demons_frame = ttk.Frame(view_notebook)
        view_notebook.add(demons_frame, text="üëπ –î–µ–º–æ–Ω—ã")
        
        demons_text = scrolledtext.ScrolledText(demons_frame, width=80, height=20, 
                                              font=('Consolas', 9), bg='#2d2d2d', fg='white',
                                              insertbackground='white')
        demons_text.pack(fill='both', expand=True, padx=5, pady=5)
        self.demons_text = demons_text
        
        # –ò–≥—Ä–æ–∫–∏
        players_frame = ttk.Frame(view_notebook)
        view_notebook.add(players_frame, text="üë§ –ò–≥—Ä–æ–∫–∏")
        
        players_text = scrolledtext.ScrolledText(players_frame, width=80, height=20,
                                               font=('Consolas', 9), bg='#2d2d2d', fg='white',
                                               insertbackground='white')
        players_text.pack(fill='both', expand=True, padx=5, pady=5)
        self.players_text = players_text
        
        # –ë—É–¥—É—â–∏–µ –¥–µ–º–æ–Ω—ã
        future_frame = ttk.Frame(view_notebook)
        view_notebook.add(future_frame, text="üîÆ –ë—É–¥—É—â–∏–µ –¥–µ–º–æ–Ω—ã")
        
        future_text = scrolledtext.ScrolledText(future_frame, width=80, height=20,
                                              font=('Consolas', 9), bg='#2d2d2d', fg='white',
                                              insertbackground='white')
        future_text.pack(fill='both', expand=True, padx=5, pady=5)
        self.future_text = future_text
        
        # –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        refresh_btn = ttk.Button(view_frame, text="üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ", command=self.load_data)
        refresh_btn.pack(pady=10)

    def create_demon_tab(self, notebook):
        demon_frame = ttk.Frame(notebook)
        notebook.add(demon_frame, text="üëπ –î–æ–±–∞–≤–∏—Ç—å –¥–µ–º–æ–Ω–∞")
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        ttk.Label(demon_frame, text="–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ–º–æ–Ω–∞", style='Subtitle.TLabel').pack(pady=20)
        
        # –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–µ–º–æ–Ω–∞
        form_frame = ttk.Frame(demon_frame)
        form_frame.pack(pady=20, padx=30)
        
        ttk.Label(form_frame, text="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ–º–æ–Ω–∞:").grid(row=0, column=0, sticky='w', pady=8)
        self.demon_name = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.demon_name.grid(row=0, column=1, pady=8, padx=10)
        
        ttk.Label(form_frame, text="–°–æ–∑–¥–∞—Ç–µ–ª—å:").grid(row=1, column=0, sticky='w', pady=8)
        self.demon_creator = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.demon_creator.grid(row=1, column=1, pady=8, padx=10)
        
        ttk.Label(form_frame, text="ID –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞:").grid(row=2, column=0, sticky='w', pady=8)
        self.demon_verifier = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.demon_verifier.grid(row=2, column=1, pady=8, padx=10)
        
        ttk.Label(form_frame, text="–î–∞—Ç–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–≥–≥–≥–≥-–º–º-–¥–¥):").grid(row=3, column=0, sticky='w', pady=8)
        self.demon_date = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.demon_date.insert(0, datetime.now().strftime("%Y-%m-%d"))
        self.demon_date.grid(row=3, column=1, pady=8, padx=10)
        
        add_btn = ttk.Button(demon_frame, text="‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–µ–º–æ–Ω–∞", command=self.add_demon_gui)
        add_btn.pack(pady=15)
        
        # –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
        separator = ttk.Separator(demon_frame, orient='horizontal')
        separator.pack(fill='x', pady=20, padx=30)
        
        # –°–ø–∏—Å–æ–∫ –¥–µ–º–æ–Ω–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        ttk.Label(demon_frame, text="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–º–æ–Ω–æ–≤", style='Subtitle.TLabel').pack(pady=(10, 5))
        
        edit_frame = ttk.Frame(demon_frame)
        edit_frame.pack(pady=15)
        
        ttk.Label(edit_frame, text="–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞:").grid(row=0, column=0, padx=5)
        self.demon_combobox = ttk.Combobox(edit_frame, width=25, state="readonly", font=('Segoe UI', 10))
        self.demon_combobox.grid(row=0, column=1, padx=5)
        
        edit_btn = ttk.Button(edit_frame, text="‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å", command=self.edit_demon_gui)
        edit_btn.grid(row=0, column=2, padx=10)
        
    def create_player_tab(self, notebook):
        player_frame = ttk.Frame(notebook)
        notebook.add(player_frame, text="üë§ –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞")
        
        ttk.Label(player_frame, text="–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞", style='Subtitle.TLabel').pack(pady=20)
        
        form_frame = ttk.Frame(player_frame)
        form_frame.pack(pady=20, padx=30)
        
        ttk.Label(form_frame, text="–ò–º—è –∏–≥—Ä–æ–∫–∞:").grid(row=0, column=0, sticky='w', pady=10)
        self.player_name = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.player_name.grid(row=0, column=1, pady=10, padx=10)
        
        add_btn = ttk.Button(player_frame, text="‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞", command=self.add_player_gui)
        add_btn.pack(pady=15)
        
        separator = ttk.Separator(player_frame, orient='horizontal')
        separator.pack(fill='x', pady=20, padx=30)
        
        ttk.Label(player_frame, text="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤", style='Subtitle.TLabel').pack(pady=(10, 5))
        
        edit_frame = ttk.Frame(player_frame)
        edit_frame.pack(pady=15)
        
        ttk.Label(edit_frame, text="–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞:").grid(row=0, column=0, padx=5)
        self.player_combobox = ttk.Combobox(edit_frame, width=25, state="readonly", font=('Segoe UI', 10))
        self.player_combobox.grid(row=0, column=1, padx=5)
        
        edit_btn = ttk.Button(edit_frame, text="‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å", command=self.edit_player_gui)
        edit_btn.grid(row=0, column=2, padx=10)
    
    def create_future_tab(self, notebook):
        future_frame = ttk.Frame(notebook)
        notebook.add(future_frame, text="üîÆ –ë—É–¥—É—â–∏–µ –¥–µ–º–æ–Ω—ã")
        
        ttk.Label(future_frame, text="–ë—É–¥—É—â–∏–µ –¥–µ–º–æ–Ω—ã", style='Subtitle.TLabel').pack(pady=20)
        
        form_frame = ttk.Frame(future_frame)
        form_frame.pack(pady=20, padx=30)
        
        ttk.Label(form_frame, text="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ–º–æ–Ω–∞:").grid(row=0, column=0, sticky='w', pady=8)
        self.future_name = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.future_name.grid(row=0, column=1, pady=8, padx=10)
        
        ttk.Label(form_frame, text="–°–æ–∑–¥–∞—Ç–µ–ª—å:").grid(row=1, column=0, sticky='w', pady=8)
        self.future_creator = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.future_creator.grid(row=1, column=1, pady=8, padx=10)
        
        ttk.Label(form_frame, text="–°–ª–æ–∂–Ω–æ—Å—Ç—å:").grid(row=2, column=0, sticky='w', pady=8)
        self.future_difficulty = ttk.Entry(form_frame, width=30, font=('Segoe UI', 10))
        self.future_difficulty.grid(row=2, column=1, pady=8, padx=10)
        
        ttk.Label(form_frame, text="–û–ø–∏—Å–∞–Ω–∏–µ:").grid(row=3, column=0, sticky='w', pady=8)
        self.future_description = tk.Text(form_frame, width=30, height=4, font=('Segoe UI', 10))
        self.future_description.grid(row=3, column=1, pady=8, padx=10)
        
        add_btn = ttk.Button(future_frame, text="‚ûï –î–æ–±–∞–≤–∏—Ç—å –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞", command=self.add_future_demon_gui)
        add_btn.pack(pady=15)
        
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –ø—Ä–æ—Ö–æ–¥—è—â–µ–≥–æ –¥–µ–º–æ–Ω
        ttk.Label(future_frame, text="–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞ –ø—Ä–æ—Ö–æ–¥—è—â–µ–≥–æ –¥–µ–º–æ–Ω:", style='Subtitle.TLabel').pack(pady=(30, 10))
        
        beating_frame = ttk.Frame(future_frame)
        beating_frame.pack(pady=10, padx=30)
        
        ttk.Label(beating_frame, text="–î–µ–º–æ–Ω:").grid(row=0, column=0, padx=5, pady=5)
        self.beating_demon = ttk.Combobox(beating_frame, width=20, state="readonly", font=('Segoe UI', 10))
        self.beating_demon.grid(row=0, column=1, padx=5, pady=5)
        
        ttk.Label(beating_frame, text="–ò–≥—Ä–æ–∫:").grid(row=0, column=2, padx=5, pady=5)
        self.beating_player = ttk.Combobox(beating_frame, width=20, state="readonly", font=('Segoe UI', 10))
        self.beating_player.grid(row=0, column=3, padx=5, pady=5)
        
        ttk.Label(beating_frame, text="–ü—Ä–æ–≥—Ä–µ—Å—Å (%):").grid(row=1, column=0, padx=5, pady=5)
        self.beating_progress = ttk.Entry(beating_frame, width=10, font=('Segoe UI', 10))
        self.beating_progress.grid(row=1, column=1, padx=5, pady=5)
        
        ttk.Label(beating_frame, text="–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–≥–≥–≥–≥-–º–º-–¥–¥):").grid(row=2, column=0, padx=5, pady=5)
        self.beating_date = ttk.Entry(beating_frame, width=15, font=('Segoe UI', 10))
        self.beating_date.insert(0, datetime.now().strftime("%Y-%m-%d"))
        self.beating_date.grid(row=2, column=1, padx=5, pady=5)
        
        add_beating_btn = ttk.Button(beating_frame, text="üéØ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ", command=self.add_beating_player_gui)
        add_beating_btn.grid(row=2, column=2, columnspan=2, padx=5, pady=5)
        
    def create_completion_tab(self, notebook):
        completion_frame = ttk.Frame(notebook)
        notebook.add(completion_frame, text="‚úÖ –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è")
        
        ttk.Label(completion_frame, text="–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–π", style='Subtitle.TLabel').pack(pady=20)
        
        form_frame = ttk.Frame(completion_frame)
        form_frame.pack(pady=20, padx=30)
        
        ttk.Label(form_frame, text="–î–µ–º–æ–Ω:").grid(row=0, column=0, padx=5, pady=8)
        self.completion_demon = ttk.Combobox(form_frame, width=20, state="readonly", font=('Segoe UI', 10))
        self.completion_demon.grid(row=0, column=1, padx=5, pady=8)
        
        ttk.Label(form_frame, text="–ò–≥—Ä–æ–∫:").grid(row=0, column=2, padx=5, pady=8)
        self.completion_player = ttk.Combobox(form_frame, width=20, state="readonly", font=('Segoe UI', 10))
        self.completion_player.grid(row=0, column=3, padx=5, pady=8)
        
        ttk.Label(form_frame, text="–î–∞—Ç–∞ (–≥–≥–≥–≥-–º–º-–¥–¥):").grid(row=1, column=0, padx=5, pady=8)
        self.completion_date = ttk.Entry(form_frame, width=20, font=('Segoe UI', 10))
        self.completion_date.insert(0, datetime.now().strftime("%Y-%m-%d"))
        self.completion_date.grid(row=1, column=1, padx=5, pady=8)
        
        add_btn = ttk.Button(form_frame, text="‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ", command=self.add_completion_gui)
        add_btn.grid(row=1, column=2, columnspan=2, padx=5, pady=8)

        # –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–≤
        refresh_btn = ttk.Button(completion_frame, text="üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–∫–∏ –¥–µ–º–æ–Ω–æ–≤ –∏ –∏–≥—Ä–æ–∫–æ–≤", 
                               command=self.load_data)
        refresh_btn.pack(pady=10)
    
    def create_calculator_tab(self, notebook):
        calc_frame = ttk.Frame(notebook)
        notebook.add(calc_frame, text="üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ—á–∫–æ–≤")
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        ttk.Label(calc_frame, text="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ—á–∫–æ–≤ –¥–µ–º–æ–Ω–ª–∏—Å—Ç–∞", style='Subtitle.TLabel').pack(pady=20)
        
        calc_container = ttk.Frame(calc_frame)
        calc_container.pack(pady=20, padx=30)
        
        # –í–≤–æ–¥ –ø–æ–∑–∏—Ü–∏–∏
        ttk.Label(calc_container, text="–ü–æ–∑–∏—Ü–∏—è –≤ –¥–µ–º–æ–Ω–ª–∏—Å—Ç–µ:").grid(row=0, column=0, sticky='w', pady=10)
        self.position_entry = ttk.Entry(calc_container, width=15, font=('Segoe UI', 12))
        self.position_entry.grid(row=0, column=1, pady=10, padx=10)
        
        # –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å—á–µ—Ç–∞
        calc_btn = ttk.Button(calc_container, text="üéØ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—á–∫–∏", 
                             command=self.calculate_points)
        calc_btn.grid(row=0, column=2, padx=20)
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç
        self.result_label = ttk.Label(calc_container, text="–û—á–∫–∏: 0", 
                                    font=('Segoe UI', 14, 'bold'), foreground='#6bc5ff')
        self.result_label.grid(row=1, column=0, columnspan=3, pady=20)
        
        # –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–ø-20 –ø–æ–∑–∏—Ü–∏–π
        ttk.Label(calc_container, text="–¢–æ–ø-20 –ø–æ–∑–∏—Ü–∏–π:", style='Subtitle.TLabel').grid(row=2, column=0, columnspan=3, pady=(30, 10))
        
        # –§—Ä–µ–π–º –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
        table_frame = ttk.Frame(calc_container)
        table_frame.grid(row=3, column=0, columnspan=3, sticky='we', pady=10)
        
        # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
        columns = ('#1', '#2', '#3', '#4', '#5')
        tree = ttk.Treeview(table_frame, columns=columns, show='headings', height=10)
        
        # –ó–∞–≥–æ–ª–æ–≤–∫–∏
        tree.heading('#1', text='–ü–æ–∑.')
        tree.heading('#2', text='–û—á–∫–∏')
        tree.heading('#3', text='–ü–æ–∑.')
        tree.heading('#4', text='–û—á–∫–∏')
        tree.heading('#5', text='–ü–æ–∑.')
        
        tree.column('#1', width=80, anchor='center')
        tree.column('#2', width=120, anchor='center')
        tree.column('#3', width=80, anchor='center')
        tree.column('#4', width=120, anchor='center')
        tree.column('#5', width=80, anchor='center')
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É
        for i in range(0, 20, 5):
            values = []
            for j in range(5):
                pos = i + j + 1
                if pos <= 20:
                    points = self.calculate_points_for_position(pos)
                    if j == 0:
                        values.extend([f"{pos}", f"{points:.2f}"])
                    else:
                        values.extend([f"{pos}", f"{points:.2f}"])
                else:
                    values.extend(["", ""])
            tree.insert('', 'end', values=values)
        
        tree.pack(fill='both', expand=True)
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–æ—Ä–º—É–ª–µ
        info_text = """üìä –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞: –¢–æ–ø-1 = 500 –æ—á–∫–æ–≤, –∫–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è –ø–æ–∑–∏—Ü–∏—è —Ç–µ—Ä—è–µ—Ç 19% –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π"""
        info_label = ttk.Label(calc_container, text=info_text, font=('Segoe UI', 9), foreground='#cccccc')
        info_label.grid(row=4, column=0, columnspan=3, pady=20)
    
    def create_ranking_tab(self, notebook):
        ranking_frame = ttk.Frame(notebook)
        notebook.add(ranking_frame, text="üèÜ –†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–ø–∞")
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        ttk.Label(ranking_frame, text="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–º –¥–µ–º–æ–Ω–æ–≤", style='Title.TLabel').pack(pady=20)
        
        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        main_container = ttk.Frame(ranking_frame)
        main_container.pack(fill='both', expand=True, padx=20, pady=10)
        
        # –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - —Å–ø–∏—Å–æ–∫ –¥–µ–º–æ–Ω–æ–≤
        left_frame = ttk.LabelFrame(main_container, text="üìã –í—Å–µ –¥–µ–º–æ–Ω—ã", padding=10)
        left_frame.pack(side='left', fill='both', expand=True, padx=(0, 10))
        
        # –ü–æ–∏—Å–∫ –¥–µ–º–æ–Ω–æ–≤
        search_frame = ttk.Frame(left_frame)
        search_frame.pack(fill='x', pady=(0, 10))
        
        ttk.Label(search_frame, text="–ü–æ–∏—Å–∫:").pack(side='left')
        self.demon_search = ttk.Entry(search_frame, font=('Segoe UI', 10))
        self.demon_search.pack(side='left', fill='x', expand=True, padx=5)
        self.demon_search.bind('<KeyRelease>', self.filter_demons)
        
        # –°–ø–∏—Å–æ–∫ –¥–µ–º–æ–Ω–æ–≤ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
        demon_list_frame = ttk.Frame(left_frame)
        demon_list_frame.pack(fill='both', expand=True)
        
        self.demon_listbox = tk.Listbox(demon_list_frame, font=('Segoe UI', 10), bg='#2d2d2d', fg='white',
                                      selectbackground='#ff6b6b', selectforeground='white')
        demon_scrollbar = ttk.Scrollbar(demon_list_frame, orient='vertical', command=self.demon_listbox.yview)
        self.demon_listbox.configure(yscrollcommand=demon_scrollbar.set)
        
        self.demon_listbox.pack(side='left', fill='both', expand=True)
        demon_scrollbar.pack(side='right', fill='y')
        
        # –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - —Ç–µ–∫—É—â–∏–π —Ç–æ–ø
        right_frame = ttk.LabelFrame(main_container, text="üèÖ –¢–µ–∫—É—â–∏–π —Ç–æ–ø –¥–µ–º–æ–Ω–æ–≤", padding=10)
        right_frame.pack(side='right', fill='both', expand=True, padx=(10, 0))
        
        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ø–æ–º
        control_frame = ttk.Frame(right_frame)
        control_frame.pack(fill='x', pady=(0, 10))
        
        ttk.Button(control_frame, text="‚¨ÜÔ∏è –ü–æ–¥–Ω—è—Ç—å", 
                  command=lambda: self.move_demon(-1)).pack(side='left', padx=2)
        ttk.Button(control_frame, text="‚¨áÔ∏è –û–ø—É—Å—Ç–∏—Ç—å", 
                  command=lambda: self.move_demon(1)).pack(side='left', padx=2)
        ttk.Button(control_frame, text="üéØ –í —Ç–æ–ø", 
                  command=self.add_to_top).pack(side='left', padx=2)
        ttk.Button(control_frame, text="üóëÔ∏è –£–±—Ä–∞—Ç—å", 
                  command=self.remove_from_top, style='Danger.TButton').pack(side='left', padx=2)
        
        # –°–ø–∏—Å–æ–∫ —Ç–æ–ø–∞ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
        top_list_frame = ttk.Frame(right_frame)
        top_list_frame.pack(fill='both', expand=True)
        
        self.top_listbox = tk.Listbox(top_list_frame, font=('Segoe UI', 10), bg='#2d2d2d', fg='white',
                                    selectbackground='#6bc5ff', selectforeground='white')
        top_scrollbar = ttk.Scrollbar(top_list_frame, orient='vertical', command=self.top_listbox.yview)
        self.top_listbox.configure(yscrollcommand=top_scrollbar.set)
        
        self.top_listbox.pack(side='left', fill='both', expand=True)
        top_scrollbar.pack(side='right', fill='y')
        
        # –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        bottom_frame = ttk.Frame(ranking_frame)
        bottom_frame.pack(fill='x', pady=10)
        
        ttk.Button(bottom_frame, text="üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–∫–∏", 
                  command=self.update_ranking_lists).pack(side='left', padx=5)
        ttk.Button(bottom_frame, text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ø", 
                  command=self.save_top_list, style='Success.TButton').pack(side='left', padx=5)
        ttk.Button(bottom_frame, text="üìä –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ø", 
                  command=self.view_top_list).pack(side='left', padx=5)
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        info_label = ttk.Label(ranking_frame, 
                              text="üí° –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –¥–µ–º–æ–Ω–æ–≤ –º–µ–∂–¥—É —Å–ø–∏—Å–∫–∞–º–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–ø–æ–º",
                              font=('Segoe UI', 9), foreground='#cccccc')
        info_label.pack(pady=5)
        
    def create_code_editor_tab(self, notebook):
        editor_frame = ttk.Frame(notebook)
        notebook.add(editor_frame, text="üìù –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞")
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        ttk.Label(editor_frame, text="–†–µ–¥–∞–∫—Ç–æ—Ä —Ñ–∞–π–ª–æ–≤ –¥–µ–º–æ–Ω–ª–∏—Å—Ç–∞", style='Title.TLabel').pack(pady=20)
        
        # –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞
        file_frame = ttk.Frame(editor_frame)
        file_frame.pack(fill='x', padx=20, pady=10)
        
        ttk.Label(file_frame, text="–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª:").pack(side='left')
        self.file_selector = ttk.Combobox(file_frame, width=20, state="readonly", font=('Segoe UI', 10))
        self.file_selector['values'] = ['demons.js', 'players.js', 'futuredemons.js', 'list.js']
        self.file_selector.set('demons.js')
        self.file_selector.pack(side='left', padx=10)
        
        ttk.Button(file_frame, text="üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª", 
                  command=self.load_file_for_edit).pack(side='left', padx=5)
        
        # –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞
        editor_container = ttk.Frame(editor_frame)
        editor_container.pack(fill='both', expand=True, padx=20, pady=10)
        
        self.code_editor = scrolledtext.ScrolledText(editor_container, 
                                                   font=('Consolas', 10), 
                                                   bg='#1e1e1e', 
                                                   fg='#d4d4d4',
                                                   insertbackground='white',
                                                   wrap=tk.NONE)
        self.code_editor.pack(fill='both', expand=True)
        
        # –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º
        editor_controls = ttk.Frame(editor_frame)
        editor_controls.pack(fill='x', padx=20, pady=10)
        
        ttk.Button(editor_controls, text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª", 
                  command=self.save_edited_file, style='Success.TButton').pack(side='left', padx=5)
        ttk.Button(editor_controls, text="üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏–∑ —Å–∏—Å—Ç–µ–º—ã", 
                  command=self.reload_from_system).pack(side='left', padx=5)
        ttk.Button(editor_controls, text="üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å", 
                  command=self.validate_syntax).pack(side='left', padx=5)
        
        # –°—Ç–∞—Ç—É—Å
        self.editor_status = ttk.Label(editor_frame, text="–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ", font=('Segoe UI', 9))
        self.editor_status.pack(pady=5)

    def create_delete_tab(self, notebook):
        delete_frame = ttk.Frame(notebook)
        notebook.add(delete_frame, text="üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ")
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        ttk.Label(delete_frame, text="–°–∏—Å—Ç–µ–º–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö", style='Title.TLabel').pack(pady=20)
        
        # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è
        delete_container = ttk.Frame(delete_frame)
        delete_container.pack(pady=20, padx=30)
        
        # –£–¥–∞–ª–µ–Ω–∏–µ –¥–µ–º–æ–Ω–æ–≤
        demon_delete_frame = ttk.LabelFrame(delete_container, text="üëπ –£–¥–∞–ª–µ–Ω–∏–µ –¥–µ–º–æ–Ω–æ–≤", padding=15)
        demon_delete_frame.grid(row=0, column=0, padx=10, pady=10, sticky='we')
        
        ttk.Label(demon_delete_frame, text="–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞:").pack(pady=5)
        self.delete_demon_combobox = ttk.Combobox(demon_delete_frame, width=30, state="readonly", font=('Segoe UI', 10))
        self.delete_demon_combobox.pack(pady=5)
        
        delete_demon_btn = ttk.Button(demon_delete_frame, text="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –¥–µ–º–æ–Ω–∞", 
                                    command=self.delete_demon_gui, style='Danger.TButton')
        delete_demon_btn.pack(pady=10)
        
        # –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤
        player_delete_frame = ttk.LabelFrame(delete_container, text="üë§ –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤", padding=15)
        player_delete_frame.grid(row=0, column=1, padx=10, pady=10, sticky='we')
        
        ttk.Label(player_delete_frame, text="–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞:").pack(pady=5)
        self.delete_player_combobox = ttk.Combobox(player_delete_frame, width=30, state="readonly", font=('Segoe UI', 10))
        self.delete_player_combobox.pack(pady=5)
        
        delete_player_btn = ttk.Button(player_delete_frame, text="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞", 
                                     command=self.delete_player_gui, style='Danger.TButton')
        delete_player_btn.pack(pady=10)
        
        # –£–¥–∞–ª–µ–Ω–∏–µ –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤
        future_delete_frame = ttk.LabelFrame(delete_container, text="üîÆ –£–¥–∞–ª–µ–Ω–∏–µ –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤", padding=15)
        future_delete_frame.grid(row=1, column=0, padx=10, pady=10, sticky='we')
        
        ttk.Label(future_delete_frame, text="–í—ã–±–µ—Ä–∏—Ç–µ –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞:").pack(pady=5)
        self.delete_future_combobox = ttk.Combobox(future_delete_frame, width=30, state="readonly", font=('Segoe UI', 10))
        self.delete_future_combobox.pack(pady=5)
        
        delete_future_btn = ttk.Button(future_delete_frame, text="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞", 
                                     command=self.delete_future_demon_gui, style='Danger.TButton')
        delete_future_btn.pack(pady=10)
        
        # –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–π
        completion_delete_frame = ttk.LabelFrame(delete_container, text="‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–π", padding=15)
        completion_delete_frame.grid(row=1, column=1, padx=10, pady=10, sticky='we')
        
        ttk.Label(completion_delete_frame, text="–î–µ–º–æ–Ω:").pack(pady=2)
        self.delete_completion_demon = ttk.Combobox(completion_delete_frame, width=25, state="readonly", font=('Segoe UI', 10))
        self.delete_completion_demon.pack(pady=2)
        
        ttk.Label(completion_delete_frame, text="–ò–≥—Ä–æ–∫:").pack(pady=2)
        self.delete_completion_player = ttk.Combobox(completion_delete_frame, width=25, state="readonly", font=('Segoe UI', 10))
        self.delete_completion_player.pack(pady=2)
        
        delete_completion_btn = ttk.Button(completion_delete_frame, text="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ", 
                                         command=self.delete_completion_gui, style='Danger.TButton')
        delete_completion_btn.pack(pady=10)
        
        # –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤
        beating_delete_frame = ttk.LabelFrame(delete_container, text="üéØ –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö –∏–≥—Ä–æ–∫–æ–≤", padding=15)
        beating_delete_frame.grid(row=2, column=0, columnspan=2, padx=10, pady=10, sticky='we')
        
        ttk.Label(beating_delete_frame, text="–ë—É–¥—É—â–∏–π –¥–µ–º–æ–Ω:").pack(pady=2)
        self.delete_beating_demon = ttk.Combobox(beating_delete_frame, width=25, state="readonly", font=('Segoe UI', 10))
        self.delete_beating_demon.pack(pady=2)
        
        ttk.Label(beating_delete_frame, text="–ò–≥—Ä–æ–∫:").pack(pady=2)
        self.delete_beating_player = ttk.Combobox(beating_delete_frame, width=25, state="readonly", font=('Segoe UI', 10))
        self.delete_beating_player.pack(pady=2)
        
        delete_beating_btn = ttk.Button(beating_delete_frame, text="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞", 
                                      command=self.delete_beating_player_gui, style='Danger.TButton')
        delete_beating_btn.pack(pady=10)
        
        # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
        warning_label = ttk.Label(delete_frame, 
                                text="‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ! –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏.",
                                font=('Segoe UI', 10, 'bold'), 
                                foreground='#ff6b6b')
        warning_label.pack(pady=20)

    # –ú–ï–¢–û–î–´ –î–õ–Ø –°–ò–°–¢–ï–ú–´ –†–ê–°–°–¢–ê–ù–û–í–ö–ò –¢–û–ü–ê
    def update_ranking_lists(self):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–∫–∏ –¥–µ–º–æ–Ω–æ–≤ –∏ —Ç–æ–ø–∞"""
        try:
            demons = self.load_demons()
            top_list = self.load_top_list()
            
            # –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–∫–∏
            self.demon_listbox.delete(0, tk.END)
            self.top_listbox.delete(0, tk.END)
            
            # –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–µ–º–æ–Ω–æ–≤
            demon_ids_in_top = set(top_list)
            for demon in demons:
                display_text = f"{demon['id']}: {demon['name']} (by {demon['creator']})"
                if demon['id'] not in demon_ids_in_top:
                    self.demon_listbox.insert(tk.END, display_text)
            
            # –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–ø–∞
            for demon_id in top_list:
                demon = next((d for d in demons if d['id'] == demon_id), None)
                if demon:
                    display_text = f"{demon['id']}: {demon['name']}"
                    self.top_listbox.insert(tk.END, display_text)
                    
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–∫–∏: {e}")
            
    def filter_demons(self, event=None):
        """–§–∏–ª—å—Ç—Ä—É–µ—Ç –¥–µ–º–æ–Ω–æ–≤ –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É"""
        search_term = self.demon_search.get().lower()
        demons = self.load_demons()
        top_list = self.load_top_list()
        
        self.demon_listbox.delete(0, tk.END)
        
        demon_ids_in_top = set(top_list)
        for demon in demons:
            if demon['id'] not in demon_ids_in_top:
                display_text = f"{demon['id']}: {demon['name']} (by {demon['creator']})"
                if search_term in display_text.lower():
                    self.demon_listbox.insert(tk.END, display_text)
                    
    def load_top_list(self):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ —Ç–æ–ø–∞"""
        try:
            with open(self.list_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            match = re.search(r'const demonList = (\[.*?\]);', content, re.DOTALL)
            if match:
                return json.loads(match.group(1))
            return []
        except:
            return []
            
    def add_to_top(self):
        """–î–æ–±–∞–≤–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–µ–º–æ–Ω–∞ –≤ —Ç–æ–ø"""
        try:
            selection = self.demon_listbox.curselection()
            if not selection:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Ç–æ–ø!")
                return
                
            demon_text = self.demon_listbox.get(selection[0])
            demon_id = int(demon_text.split(':')[0])
            
            top_list = self.load_top_list()
            if demon_id in top_list:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–≠—Ç–æ—Ç –¥–µ–º–æ–Ω —É–∂–µ –≤ —Ç–æ–ø–µ!")
                return
                
            top_list.append(demon_id)
            self.save_top_list_internal(top_list)
            self.update_ranking_lists()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –¥–µ–º–æ–Ω–∞ –≤ —Ç–æ–ø: {e}")
            
    def remove_from_top(self):
        """–£–±–∏—Ä–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–µ–º–æ–Ω–∞ –∏–∑ —Ç–æ–ø–∞"""
        try:
            selection = self.top_listbox.curselection()
            if not selection:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ —Ç–æ–ø–∞!")
                return
                
            demon_text = self.top_listbox.get(selection[0])
            demon_id = int(demon_text.split(':')[0])
            
            top_list = self.load_top_list()
            top_list = [id for id in top_list if id != demon_id]
            
            self.save_top_list_internal(top_list)
            self.update_ranking_lists()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –¥–µ–º–æ–Ω–∞ –∏–∑ —Ç–æ–ø–∞: {e}")
            
    def move_demon(self, direction):
        """–ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –¥–µ–º–æ–Ω–∞ –≤ —Ç–æ–ø–µ –≤–≤–µ—Ä—Ö –∏–ª–∏ –≤–Ω–∏–∑"""
        try:
            selection = self.top_listbox.curselection()
            if not selection:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è!")
                return
                
            index = selection[0]
            top_list = self.load_top_list()
            
            if direction == -1 and index > 0:  # –í–≤–µ—Ä—Ö
                top_list[index], top_list[index-1] = top_list[index-1], top_list[index]
            elif direction == 1 and index < len(top_list) - 1:  # –í–Ω–∏–∑
                top_list[index], top_list[index+1] = top_list[index+1], top_list[index]
            else:
                return
                
            self.save_top_list_internal(top_list)
            self.update_ranking_lists()
            self.top_listbox.select_set(index + direction)
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –¥–µ–º–æ–Ω–∞: {e}")
            
    def save_top_list(self):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π —Ç–æ–ø"""
        try:
            top_list = self.load_top_list()
            self.save_top_list_internal(top_list)
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–¢–æ–ø –¥–µ–º–æ–Ω–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!")
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ø: {e}")
            
    def save_top_list_internal(self, top_list):
        """–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–µ—Ç–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–ø–∞"""
        with open(self.list_file, 'r', encoding='utf-8') as f:
            content = f.read()
        
        new_list = f"const demonList = {json.dumps(top_list)};"
        content = re.sub(r'const demonList = \[.*?\];', new_list, content, flags=re.DOTALL)
        
        with open(self.list_file, 'w', encoding='utf-8') as f:
            f.write(content)
            
    def view_top_list(self):
        """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Ç–æ–ø –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ"""
        try:
            top_list = self.load_top_list()
            demons = self.load_demons()
            
            view_window = tk.Toplevel(self.root)
            view_window.title("–¢–µ–∫—É—â–∏–π —Ç–æ–ø –¥–µ–º–æ–Ω–æ–≤")
            view_window.geometry("600x400")
            
            text_area = scrolledtext.ScrolledText(view_window, font=('Consolas', 10))
            text_area.pack(fill='both', expand=True, padx=10, pady=10)
            
            text_area.insert(tk.END, "üèÜ –¢–û–ü –î–ï–ú–û–ù–û–í:\n\n")
            for i, demon_id in enumerate(top_list, 1):
                demon = next((d for d in demons if d['id'] == demon_id), None)
                if demon:
                    text_area.insert(tk.END, f"{i}. {demon['name']} (by {demon['creator']}) - ID: {demon_id}\n")
                else:
                    text_area.insert(tk.END, f"{i}. –î–µ–º–æ–Ω —Å ID {demon_id} –Ω–µ –Ω–∞–π–¥–µ–Ω\n")
                    
            text_area.config(state=tk.DISABLED)
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ø: {e}")

    # –ú–ï–¢–û–î–´ –î–õ–Ø –†–ï–î–ê–ö–¢–û–†–ê –ö–û–î–ê
    def load_file_for_edit(self):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä"""
        try:
            filename = self.file_selector.get()
            filepath = f"js/{filename}"
            
            with open(filepath, 'r', encoding='utf-8') as f:
                content = f.read()
            
            self.code_editor.delete(1.0, tk.END)
            self.code_editor.insert(1.0, content)
            self.editor_status.config(text=f"–§–∞–π–ª {filename} –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ")
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª: {e}")
            
    def save_edited_file(self):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤ —Ñ–∞–π–ª"""
        try:
            filename = self.file_selector.get()
            filepath = f"js/{filename}"
            content = self.code_editor.get(1.0, tk.END)
            
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(content)
            
            self.editor_status.config(text=f"–§–∞–π–ª {filename} —Å–æ—Ö—Ä–∞–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ")
            messagebox.showinfo("–£—Å–ø–µ—Ö", f"–§–∞–π–ª {filename} —Å–æ—Ö—Ä–∞–Ω–µ–Ω!")
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª: {e}")
            
    def reload_from_system(self):
        """–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä"""
        try:
            filename = self.file_selector.get()
            
            if filename == 'demons.js':
                demons = self.load_demons()
                content = f"const demons = {json.dumps(demons, indent=2, ensure_ascii=False)};"
            elif filename == 'players.js':
                players = self.load_players()
                content = f"const players = {json.dumps(players, indent=2, ensure_ascii=False)};"
            elif filename == 'futuredemons.js':
                future_demons = self.load_future_demons()
                content = f"const futureDemons = {json.dumps(future_demons, indent=2, ensure_ascii=False)};"
            elif filename == 'list.js':
                with open(self.list_file, 'r', encoding='utf-8') as f:
                    content = f.read()
            
            self.code_editor.delete(1.0, tk.END)
            self.code_editor.insert(1.0, content)
            self.editor_status.config(text=f"–î–∞–Ω–Ω—ã–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ {filename}")
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ: {e}")
            
    def validate_syntax(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å JSON –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ"""
        try:
            content = self.code_editor.get(1.0, tk.END)
            
            # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ JSON –≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º
            json_match = re.search(r'=\s*(\[.*\]|{.*});', content, re.DOTALL)
            if json_match:
                json_str = json_match.group(1)
                json.loads(json_str)  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JSON
                self.editor_status.config(text="‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å JSON –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω")
                messagebox.showinfo("–ü—Ä–æ–≤–µ—Ä–∫–∞", "–°–∏–Ω—Ç–∞–∫—Å–∏—Å JSON –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω!")
            else:
                self.editor_status.config(text="‚ö†Ô∏è JSON –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ñ–∞–π–ª–µ")
                
        except json.JSONDecodeError as e:
            self.editor_status.config(text="‚ùå –û—à–∏–±–∫–∞ –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ JSON")
            messagebox.showerror("–û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞", f"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON: {e}")
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: {e}")

    # –ú–ï–¢–û–î–´ –£–î–ê–õ–ï–ù–ò–Ø
    def delete_demon_gui(self):
        """–£–¥–∞–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–µ–º–æ–Ω–∞"""
        try:
            demon_str = self.delete_demon_combobox.get()
            if not demon_str:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!")
                return
            
            demon_id = int(demon_str.split(':')[0])
            demon_name = demon_str.split(':', 1)[1].strip()
            
            # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if not messagebox.askyesno("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ", 
                                     f"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –¥–µ–º–æ–Ω–∞:\n{demon_name}?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!"):
                return
            
            demons = self.load_demons()
            players = self.load_players()
            
            # –£–¥–∞–ª—è–µ–º –¥–µ–º–æ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
            demons = [d for d in demons if d['id'] != demon_id]
            
            # –£–¥–∞–ª—è–µ–º –¥–µ–º–æ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —É –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
            for player in players:
                if demon_id in player['completedDemons']:
                    player['completedDemons'].remove(demon_id)
            
            self.save_demons(demons)
            self.save_players(players)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏—Å–æ–∫ –¥–µ–º–æ–Ω–æ–≤
            demon_ids = [d['id'] for d in demons]
            self.update_demon_list(demon_ids)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", f"–î–µ–º–æ–Ω '{demon_name}' —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!")
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –¥–µ–º–æ–Ω–∞: {e}")
    
    def delete_player_gui(self):
        """–£–¥–∞–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞"""
        try:
            player_str = self.delete_player_combobox.get()
            if not player_str:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!")
                return
            
            player_id = int(player_str.split(':')[0])
            player_name = player_str.split(':', 1)[1].strip()
            
            # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if not messagebox.askyesno("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ", 
                                     f"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞:\n{player_name}?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!"):
                return
            
            players = self.load_players()
            demons = self.load_demons()
            future_demons = self.load_future_demons()
            
            # –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
            players = [p for p in players if p['id'] != player_id]
            
            # –£–¥–∞–ª—è–µ–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –∏–∑ –≤—Å–µ—Ö –¥–µ–º–æ–Ω–æ–≤
            for demon in demons:
                demon['completers'] = [comp for comp in demon['completers'] if comp['playerId'] != player_id]
            
            # –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –∏–∑ –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤
            for demon in future_demons:
                if 'beatingPlayers' in demon:
                    demon['beatingPlayers'] = [bp for bp in demon['beatingPlayers'] if bp['playerId'] != player_id]
            
            self.save_players(players)
            self.save_demons(demons)
            self.save_future_demons(future_demons)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", f"–ò–≥—Ä–æ–∫ '{player_name}' —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!")
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞: {e}")
    
    def delete_future_demon_gui(self):
        """–£–¥–∞–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞"""
        try:
            future_str = self.delete_future_combobox.get()
            if not future_str:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!")
                return
            
            future_id = int(future_str.split(':')[0])
            future_name = future_str.split(':', 1)[1].strip()
            
            # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if not messagebox.askyesno("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ", 
                                     f"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞:\n{future_name}?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!"):
                return
            
            future_demons = self.load_future_demons()
            future_demons = [fd for fd in future_demons if fd['id'] != future_id]
            
            self.save_future_demons(future_demons)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", f"–ë—É–¥—É—â–∏–π –¥–µ–º–æ–Ω '{future_name}' —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!")
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞: {e}")
    
    def delete_completion_gui(self):
        """–£–¥–∞–ª—è–µ—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–µ–º–æ–Ω–∞ –∏–≥—Ä–æ–∫–æ–º"""
        try:
            demon_str = self.delete_completion_demon.get()
            player_str = self.delete_completion_player.get()
            
            if not all([demon_str, player_str]):
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞ –∏ –∏–≥—Ä–æ–∫–∞!")
                return
            
            demon_id = int(demon_str.split(':')[0])
            player_id = int(player_str.split(':')[0])
            demon_name = demon_str.split(':', 1)[1].strip()
            player_name = player_str.split(':', 1)[1].strip()
            
            # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if not messagebox.askyesno("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ", 
                                     f"–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–µ–º–æ–Ω–∞ {demon_name}\n–∏–≥—Ä–æ–∫–æ–º {player_name}?"):
                return
            
            demons = self.load_demons()
            players = self.load_players()
            
            # –£–¥–∞–ª—è–µ–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∏–∑ –¥–µ–º–æ–Ω–∞
            for demon in demons:
                if demon['id'] == demon_id:
                    demon['completers'] = [comp for comp in demon['completers'] if comp['playerId'] != player_id]
                    break
            
            # –£–¥–∞–ª—è–µ–º –¥–µ–º–æ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–∞
            for player in players:
                if player['id'] == player_id:
                    if demon_id in player['completedDemons']:
                        player['completedDemons'].remove(demon_id)
                    break
            
            self.save_demons(demons)
            self.save_players(players)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ!")
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ: {e}")
    
    def delete_beating_player_gui(self):
        """–£–¥–∞–ª—è–µ—Ç –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö –±—É–¥—É—â–∏–π –¥–µ–º–æ–Ω"""
        try:
            demon_str = self.delete_beating_demon.get()
            player_str = self.delete_beating_player.get()
            
            if not all([demon_str, player_str]):
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞ –∏ –∏–≥—Ä–æ–∫–∞!")
                return
            
            demon_id = int(demon_str.split(':')[0])
            player_id = int(player_str.split(':')[0])
            demon_name = demon_str.split(':', 1)[1].strip()
            player_name = player_str.split(':', 1)[1].strip()
            
            # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if not messagebox.askyesno("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ", 
                                     f"–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞ {player_name}\n–∏–∑ –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö –¥–µ–º–æ–Ω {demon_name}?"):
                return
            
            future_demons = self.load_future_demons()
            
            for demon in future_demons:
                if demon['id'] == demon_id and 'beatingPlayers' in demon:
                    demon['beatingPlayers'] = [bp for bp in demon['beatingPlayers'] if bp['playerId'] != player_id]
                    break
            
            self.save_future_demons(future_demons)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–ò–≥—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω –∏–∑ –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö!")
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞: {e}")

    # –û–°–ù–û–í–ù–´–ï –ú–ï–¢–û–î–´ –†–ê–ë–û–¢–´ –° –î–ê–ù–ù–´–ú–ò
    def calculate_points_for_position(self, position):
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ—á–∫–∏ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ –ø–æ —Ñ–æ—Ä–º—É–ª–µ"""
        if position < 1:
            return 0
        base_points = 500.0
        decay_rate = 0.19  # 19%
        
        points = base_points
        for i in range(2, position + 1):
            points *= (1 - decay_rate)
        
        return points
    
    def calculate_points(self):
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ—á–∫–∏ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏"""
        try:
            position = int(self.position_entry.get())
            if position < 1:
                messagebox.showwarning("–û—à–∏–±–∫–∞", "–ü–æ–∑–∏—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0!")
                return
            
            points = self.calculate_points_for_position(position)
            self.result_label.config(text=f"–û—á–∫–∏ –∑–∞ –ø–æ–∑–∏—Ü–∏—é {position}: {points:.2f}")
            
        except ValueError:
            messagebox.showerror("–û—à–∏–±–∫–∞", "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ø–æ–∑–∏—Ü–∏—é!")

    def load_data(self):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å"""
        try:
            demons = self.load_demons()
            players = self.load_players()
            future_demons = self.load_future_demons()
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è
            self.update_demons_text(demons)
            self.update_players_text(players)
            self.update_future_text(future_demons)
            
            # –û–ë–ù–û–í–õ–Ø–ï–ú –í–°–ï –ö–û–ú–ë–û–ë–û–ö–°–´
            self.update_all_comboboxes(demons, players, future_demons)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–∫–∏ –¥–ª—è —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–æ–ø–∞
            if hasattr(self, 'demon_listbox'):
                self.update_ranking_lists()
            
        except Exception as e:
            if "'DemonlistGUI' object has no attribute" not in str(e):
                messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ: {e}")
    
    def update_all_comboboxes(self, demons, players, future_demons):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ –∫–æ–º–±–æ–±–æ–∫—Å—ã –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ"""
        try:
            # –ó–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–æ–º–±–æ–±–æ–∫—Å–æ–≤
            demon_values = [f"{d['id']}: {d['name']}" for d in demons]
            player_values = [f"{p['id']}: {p['name']}" for p in players]
            future_values = [f"{d['id']}: {d['name']}" for d in future_demons]
            
            # –ö–æ–º–±–æ–±–æ–∫—Å—ã –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–π
            if hasattr(self, 'completion_demon') and self.completion_demon:
                self.completion_demon['values'] = demon_values
            if hasattr(self, 'completion_player') and self.completion_player:
                self.completion_player['values'] = player_values
            
            # –ö–æ–º–±–æ–±–æ–∫—Å—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            if hasattr(self, 'demon_combobox') and self.demon_combobox:
                self.demon_combobox['values'] = demon_values
            if hasattr(self, 'player_combobox') and self.player_combobox:
                self.player_combobox['values'] = player_values
            
            # –ö–æ–º–±–æ–±–æ–∫—Å—ã –¥–ª—è –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤
            if hasattr(self, 'beating_demon') and self.beating_demon:
                self.beating_demon['values'] = future_values
            if hasattr(self, 'beating_player') and self.beating_player:
                self.beating_player['values'] = player_values
            
            # –ö–æ–º–±–æ–±–æ–∫—Å—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            if hasattr(self, 'delete_demon_combobox') and self.delete_demon_combobox:
                self.delete_demon_combobox['values'] = demon_values
            if hasattr(self, 'delete_player_combobox') and self.delete_player_combobox:
                self.delete_player_combobox['values'] = player_values
            if hasattr(self, 'delete_future_combobox') and self.delete_future_combobox:
                self.delete_future_combobox['values'] = future_values
            if hasattr(self, 'delete_completion_demon') and self.delete_completion_demon:
                self.delete_completion_demon['values'] = demon_values
            if hasattr(self, 'delete_completion_player') and self.delete_completion_player:
                self.delete_completion_player['values'] = player_values
            if hasattr(self, 'delete_beating_demon') and self.delete_beating_demon:
                self.delete_beating_demon['values'] = future_values
            if hasattr(self, 'delete_beating_player') and self.delete_beating_player:
                self.delete_beating_player['values'] = player_values
                
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–º–±–æ–±–æ–∫—Å–æ–≤: {e}")
    
    def load_demons(self):
        try:
            with open(self.demons_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            match = re.search(r'const demons = (\[.*?\]);', content, re.DOTALL)
            if match:
                demons_json = match.group(1)
                demons_json = demons_json.replace("'", '"')
                demons_json = re.sub(r'(\w+):', r'"\1":', demons_json)
                demons_data = json.loads(demons_json)
                return demons_data
            return []
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–º–æ–Ω–æ–≤: {e}")
            return []
    
    def load_players(self):
        try:
            with open(self.players_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            match = re.search(r'const players = (\[.*?\]);', content, re.DOTALL)
            if match:
                players_json = match.group(1)
                players_json = players_json.replace("'", '"')
                players_json = re.sub(r'(\w+):', r'"\1":', players_json)
                players_data = json.loads(players_json)
                return players_data
            return []
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤: {e}")
            return []
    
    def load_future_demons(self):
        try:
            with open(self.future_demons_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            match = re.search(r'const futureDemons = (\[.*?\]);', content, re.DOTALL)
            if match:
                future_json = match.group(1)
                future_json = future_json.replace("'", '"')
                future_json = re.sub(r'(\w+):', r'"\1":', future_json)
                return json.loads(future_json)
            return []
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤: {e}")
            return []
    
    def update_demons_text(self, demons):
        text = "üëπ –í–°–ï –î–ï–ú–û–ù–´:\n\n"
        for demon in demons:
            text += f"ID: {demon['id']}\n"
            text += f"  –ù–∞–∑–≤–∞–Ω–∏–µ: {demon['name']}\n"
            text += f"  –°–æ–∑–¥–∞—Ç–µ–ª—å: {demon['creator']}\n"
            text += f"  –í–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä: {demon['verifier']}\n"
            text += f"  –î–∞—Ç–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏: {demon['verifyDate']}\n"
            text += f"  –ü—Ä–æ—à–ª–∏: {len(demon['completers'])} –∏–≥—Ä–æ–∫–æ–≤\n"
            if demon['completers']:
                text += "  –ü—Ä–æ—à–µ–¥—à–∏–µ –∏–≥—Ä–æ–∫–∏:\n"
                for comp in demon['completers']:
                    text += f"    - –ò–≥—Ä–æ–∫ ID: {comp['playerId']}, –î–∞—Ç–∞: {comp['date']}\n"
            text += "\n"
        
        self.demons_text.delete(1.0, tk.END)
        self.demons_text.insert(1.0, text)
    
    def update_players_text(self, players):
        text = "üë§ –í–°–ï –ò–ì–†–û–ö–ò:\n\n"
        for player in players:
            text += f"ID: {player['id']}\n"
            text += f"  –ò–º—è: {player['name']}\n"
            text += f"  –ü—Ä–æ–π–¥–µ–Ω–æ –¥–µ–º–æ–Ω–æ–≤: {len(player['completedDemons'])}\n"
            if player['completedDemons']:
                text += f"  –ü—Ä–æ–π–¥–µ–Ω–Ω—ã–µ –¥–µ–º–æ–Ω—ã: {player['completedDemons']}\n"
            text += "\n"
        
        self.players_text.delete(1.0, tk.END)
        self.players_text.insert(1.0, text)
    
    def update_future_text(self, future_demons):
        text = "üîÆ –ë–£–î–£–©–ò–ï –î–ï–ú–û–ù–´:\n\n"
        for demon in future_demons:
            text += f"ID: {demon['id']}\n"
            text += f"  –ù–∞–∑–≤–∞–Ω–∏–µ: {demon['name']}\n"
            text += f"  –°–æ–∑–¥–∞—Ç–µ–ª—å: {demon['creator']}\n"
            text += f"  –°–ª–æ–∂–Ω–æ—Å—Ç—å: {demon['difficulty']}\n"
            text += f"  –û–ø–∏—Å–∞–Ω–∏–µ: {demon['description']}\n"
            text += f"  –ò–≥—Ä–æ–∫–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç: {len(demon.get('beatingPlayers', []))}\n"
            if demon.get('beatingPlayers'):
                for bp in demon['beatingPlayers']:
                    text += f"    - –ò–≥—Ä–æ–∫ ID: {bp['playerId']}, –ü—Ä–æ–≥—Ä–µ—Å—Å: {bp['progress']}%, –û–±–Ω–æ–≤–ª–µ–Ω–æ: {bp['lastUpdate']}\n"
            text += "\n"
        
        self.future_text.delete(1.0, tk.END)
        self.future_text.insert(1.0, text)

    # –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ú–ï–¢–û–î–´ –°–û–•–†–ê–ù–ï–ù–ò–Ø
    def save_demons(self, demons):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–µ–º–æ–Ω–æ–≤, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"""
        try:
            with open(self.demons_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            # –ù–∞—Ö–æ–¥–∏–º –∏ –∑–∞–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤ demons
            new_demons_js = f"const demons = {json.dumps(demons, indent=2, ensure_ascii=False)};"
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–º–µ–Ω—ã –∏–º–µ–Ω–Ω–æ –º–∞—Å—Å–∏–≤–∞ demons
            pattern = r'const demons = \[.*?\];'
            if re.search(pattern, content, re.DOTALL):
                content = re.sub(pattern, new_demons_js, content, flags=re.DOTALL)
            else:
                # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Å—Ç–∞—Ä—ã–π –º–∞—Å—Å–∏–≤, –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π (—Å–æ—Ö—Ä–∞–Ω—è—è –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
                content = content + "\n\n" + new_demons_js
            
            with open(self.demons_file, 'w', encoding='utf-8') as f:
                f.write(content)
                
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–µ–º–æ–Ω–æ–≤: {e}")

    def save_players(self, players):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–≥—Ä–æ–∫–æ–≤, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"""
        try:
            with open(self.players_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            # –ù–∞—Ö–æ–¥–∏–º –∏ –∑–∞–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤ players
            new_players_js = f"const players = {json.dumps(players, indent=2, ensure_ascii=False)};"
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–º–µ–Ω—ã –∏–º–µ–Ω–Ω–æ –º–∞—Å—Å–∏–≤–∞ players
            pattern = r'const players = \[.*?\];'
            if re.search(pattern, content, re.DOTALL):
                content = re.sub(pattern, new_players_js, content, flags=re.DOTALL)
            else:
                # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Å—Ç–∞—Ä—ã–π –º–∞—Å—Å–∏–≤, –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π (—Å–æ—Ö—Ä–∞–Ω—è—è –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
                content = content + "\n\n" + new_players_js
            
            with open(self.players_file, 'w', encoding='utf-8') as f:
                f.write(content)
                
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–æ–≤: {e}")

    def save_future_demons(self, future_demons):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞"""
        try:
            with open(self.future_demons_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            # –ù–∞—Ö–æ–¥–∏–º –∏ –∑–∞–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤ futureDemons
            new_future_js = f"const futureDemons = {json.dumps(future_demons, indent=2, ensure_ascii=False)};"
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–º–µ–Ω—ã –∏–º–µ–Ω–Ω–æ –º–∞—Å—Å–∏–≤–∞ futureDemons
            pattern = r'const futureDemons = \[.*?\];'
            if re.search(pattern, content, re.DOTALL):
                content = re.sub(pattern, new_future_js, content, flags=re.DOTALL)
            else:
                # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Å—Ç–∞—Ä—ã–π –º–∞—Å—Å–∏–≤, –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π (—Å–æ—Ö—Ä–∞–Ω—è—è –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
                content = content + "\n\n" + new_future_js
            
            with open(self.future_demons_file, 'w', encoding='utf-8') as f:
                f.write(content)
                
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤: {e}")

    # –ú–ï–¢–û–î–´ –î–û–ë–ê–í–õ–ï–ù–ò–Ø –î–ê–ù–ù–´–•
    def add_demon_gui(self):
        try:
            name = self.demon_name.get().strip()
            creator = self.demon_creator.get().strip()
            verifier = self.demon_verifier.get().strip()
            date = self.demon_date.get().strip()
            
            if not all([name, creator, verifier, date]):
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—Å–µ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!")
                return
            
            demons = self.load_demons()
            next_id = max([d['id'] for d in demons]) + 1 if demons else 1
            
            demon = {
                "id": next_id,
                "name": name,
                "creator": creator,
                "verifier": int(verifier),
                "verifyDate": date,
                "completers": [{"playerId": int(verifier), "date": date}]
            }
            
            demons.append(demon)
            self.save_demons(demons)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–µ–º–æ–Ω–æ–≤
            demon_ids = [d['id'] for d in demons]
            self.update_demon_list(demon_ids)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", f"–î–µ–º–æ–Ω '{name}' –¥–æ–±–∞–≤–ª–µ–Ω —Å ID {next_id}")
            
            # –û—á–∏—â–∞–µ–º –ø–æ–ª—è –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            self.demon_name.delete(0, tk.END)
            self.demon_creator.delete(0, tk.END)
            self.demon_verifier.delete(0, tk.END)
            self.demon_date.delete(0, tk.END)
            self.demon_date.insert(0, datetime.now().strftime("%Y-%m-%d"))
            
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –¥–µ–º–æ–Ω–∞: {e}")
    
    def add_player_gui(self):
        try:
            name = self.player_name.get().strip()
            
            if not name:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞!")
                return
            
            players = self.load_players()
            next_id = max([p['id'] for p in players]) + 1 if players else 1
            
            player = {
                "id": next_id,
                "name": name,
                "completedDemons": []
            }
            
            players.append(player)
            self.save_players(players)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", f"–ò–≥—Ä–æ–∫ '{name}' –¥–æ–±–∞–≤–ª–µ–Ω —Å ID {next_id}")
            
            # –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            self.player_name.delete(0, tk.END)
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞: {e}")
    
    def add_future_demon_gui(self):
        try:
            name = self.future_name.get().strip()
            creator = self.future_creator.get().strip()
            difficulty = self.future_difficulty.get().strip()
            description = self.future_description.get(1.0, tk.END).strip()
            
            if not all([name, creator, difficulty, description]):
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—Å–µ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!")
                return
            
            future_demons = self.load_future_demons()
            next_id = max([d['id'] for d in future_demons]) + 1 if future_demons else 1
            
            future_demon = {
                "id": next_id,
                "name": name,
                "creator": creator,
                "difficulty": difficulty,
                "description": description,
                "beatingPlayers": []
            }
            
            future_demons.append(future_demon)
            self.save_future_demons(future_demons)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", f"–ë—É–¥—É—â–∏–π –¥–µ–º–æ–Ω '{name}' –¥–æ–±–∞–≤–ª–µ–Ω —Å ID {next_id}")
            
            # –û—á–∏—â–∞–µ–º –ø–æ–ª—è –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            self.future_name.delete(0, tk.END)
            self.future_creator.delete(0, tk.END)
            self.future_difficulty.delete(0, tk.END)
            self.future_description.delete(1.0, tk.END)
            
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞: {e}")
    
    def add_completion_gui(self):
        try:
            demon_str = self.completion_demon.get()
            player_str = self.completion_player.get()
            date = self.completion_date.get().strip()
            
            if not all([demon_str, player_str, date]):
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—Å–µ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!")
                return
            
            demon_id = int(demon_str.split(':')[0])
            player_id = int(player_str.split(':')[0])
            
            demons = self.load_demons()
            players = self.load_players()
            
            # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∫ –¥–µ–º–æ–Ω—É
            for demon in demons:
                if demon['id'] == demon_id:
                    if not any(comp['playerId'] == player_id for comp in demon['completers']):
                        demon['completers'].append({
                            "playerId": player_id,
                            "date": date
                        })
                    break
            
            # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–º–æ–Ω–∞ –∫ –∏–≥—Ä–æ–∫—É
            for player in players:
                if player['id'] == player_id:
                    if demon_id not in player['completedDemons']:
                        player['completedDemons'].append(demon_id)
                    break
            
            self.save_demons(demons)
            self.save_players(players)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!")
            
            # –û—á–∏—â–∞–µ–º –ø–æ–ª—è –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            self.completion_demon.set('')
            self.completion_player.set('')
            self.completion_date.delete(0, tk.END)
            self.completion_date.insert(0, datetime.now().strftime("%Y-%m-%d"))
            
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ: {e}")

    def add_beating_player_gui(self):
        try:
            demon_str = self.beating_demon.get()
            player_str = self.beating_player.get()
            progress = self.beating_progress.get().strip()
            date = self.beating_date.get().strip()
            
            if not all([demon_str, player_str, progress, date]):
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—Å–µ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!")
                return
            
            demon_id = int(demon_str.split(':')[0])
            player_id = int(player_str.split(':')[0])
            progress_val = int(progress)
            
            future_demons = self.load_future_demons()
            
            for demon in future_demons:
                if demon['id'] == demon_id:
                    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º beatingPlayers –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                    if 'beatingPlayers' not in demon:
                        demon['beatingPlayers'] = []
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —ç—Ç–æ—Ç –∏–≥—Ä–æ–∫
                    existing_player = None
                    for i, bp in enumerate(demon['beatingPlayers']):
                        if bp['playerId'] == player_id:
                            existing_player = i
                            break
                    
                    if existing_player is not None:
                        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
                        demon['beatingPlayers'][existing_player]['progress'] = progress_val
                        demon['beatingPlayers'][existing_player]['lastUpdate'] = date
                    else:
                        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                        demon['beatingPlayers'].append({
                            "playerId": player_id,
                            "progress": progress_val,
                            "lastUpdate": date
                        })
                    break
            
            self.save_future_demons(future_demons)
            
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–ò–≥—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω –≤ –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö –¥–µ–º–æ–Ω!")
            
            # –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            self.beating_demon.set('')
            self.beating_player.set('')
            self.beating_progress.delete(0, tk.END)
            self.beating_date.delete(0, tk.END)
            self.beating_date.insert(0, datetime.now().strftime("%Y-%m-%d"))
            
            self.load_data()
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞: {e}")

    def edit_demon_gui(self):
        try:
            demon_str = self.demon_combobox.get()
            if not demon_str:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–º–æ–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!")
                return
            
            demon_id = int(demon_str.split(':')[0])
            demons = self.load_demons()
            
            for demon in demons:
                if demon['id'] == demon_id:
                    # –°–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                    self.create_edit_demon_window(demon, demons)
                    break
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ–Ω–∞: {e}")
    
    def edit_player_gui(self):
        try:
            player_str = self.player_combobox.get()
            if not player_str:
                messagebox.showwarning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ", "–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!")
                return
            
            player_id = int(player_str.split(':')[0])
            players = self.load_players()
            
            for player in players:
                if player['id'] == player_id:
                    # –°–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                    self.create_edit_player_window(player, players)
                    break
            
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä–æ–∫–∞: {e}")
    
    def create_edit_demon_window(self, demon, demons):
        edit_window = tk.Toplevel(self.root)
        edit_window.title(f"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–º–æ–Ω–∞: {demon['name']}")
        edit_window.geometry("400x300")
        edit_window.configure(bg='#2d2d2d')
        
        ttk.Label(edit_window, text="–ù–∞–∑–≤–∞–Ω–∏–µ:").pack(pady=5)
        name_entry = ttk.Entry(edit_window, width=30, font=('Segoe UI', 10))
        name_entry.insert(0, demon['name'])
        name_entry.pack(pady=5)
        
        ttk.Label(edit_window, text="–°–æ–∑–¥–∞—Ç–µ–ª—å:").pack(pady=5)
        creator_entry = ttk.Entry(edit_window, width=30, font=('Segoe UI', 10))
        creator_entry.insert(0, demon['creator'])
        creator_entry.pack(pady=5)
        
        def save_changes():
            demon['name'] = name_entry.get().strip()
            demon['creator'] = creator_entry.get().strip()
            self.save_demons(demons)
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–î–µ–º–æ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω!")
            edit_window.destroy()
            self.load_data()
        
        ttk.Button(edit_window, text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å", command=save_changes).pack(pady=20)
    
    def create_edit_player_window(self, player, players):
        edit_window = tk.Toplevel(self.root)
        edit_window.title(f"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞: {player['name']}")
        edit_window.geometry("400x200")
        edit_window.configure(bg='#2d2d2d')
        
        ttk.Label(edit_window, text="–ò–º—è –∏–≥—Ä–æ–∫–∞:").pack(pady=5)
        name_entry = ttk.Entry(edit_window, width=30, font=('Segoe UI', 10))
        name_entry.insert(0, player['name'])
        name_entry.pack(pady=5)
        
        def save_changes():
            player['name'] = name_entry.get().strip()
            self.save_players(players)
            messagebox.showinfo("–£—Å–ø–µ—Ö", "–ò–≥—Ä–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω!")
            edit_window.destroy()
            self.load_data()
        
        ttk.Button(edit_window, text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å", command=save_changes).pack(pady=20)

    def update_demon_list(self, demon_ids):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–µ–º–æ–Ω–æ–≤ –≤ list.js"""
        try:
            with open(self.list_file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            new_list = f"const demonList = {json.dumps(demon_ids)};"
            content = re.sub(r'const demonList = \[.*?\];', new_list, content, flags=re.DOTALL)
            
            with open(self.list_file, 'w', encoding='utf-8') as f:
                f.write(content)
        except Exception as e:
            messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–µ–º–æ–Ω–æ–≤: {e}")

if __name__ == "__main__":
    root = tk.Tk()
    app = DemonlistGUI(root)
    root.mainloop()

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: demons.js

const demons = [
  {
    "id": 1,
    "name": "Beetle",
    "creator": "Cirtrax",
    "verifier": 1,
    "verifyDate": "2025-10-02",
    "completers": [
      {
        "playerId": 1,
        "date": "2025-10-02"
      },
      {
        "playerId": 3,
        "date": "2025-11-04"
      }
    ]
  },
  {
    "id": 2,
    "name": "Acropolis",
    "creator": "Zobros",
    "verifier": 1,
    "verifyDate": "2025-09-29",
    "completers": [
      {
        "playerId": 1,
        "date": "2025-09-29"
      },
      {
        "playerId": 3,
        "date": "2025-07-09"
      }
    ]
  },
  {
    "id": 3,
    "name": "Crazy II",
    "creator": "DavJT",
    "verifier": 2,
    "verifyDate": "2025-10-29",
    "completers": [
      {
        "playerId": 2,
        "date": "2025-10-29"
      },
      {
        "playerId": 3,
        "date": "2025-05-12"
      }
    ]
  },
  {
    "id": 4,
    "name": "Quantum Variations",
    "creator": "Darwin",
    "verifier": 1,
    "verifyDate": "2025-10-28",
    "completers": [
      {
        "playerId": 1,
        "date": "2025-10-28"
      }
    ]
  },
  {
    "id": 5,
    "name": "Psychosis",
    "creator": "Hinds",
    "verifier": 1,
    "verifyDate": "2025-09-29",
    "completers": [
      {
        "playerId": 1,
        "date": "2025-09-29"
      }
    ]
  },
  {
    "id": 6,
    "name": "The Furious",
    "creator": "Knobbelboy",
    "verifier": 1,
    "verifyDate": "2024-07-12",
    "completers": [
      {
        "playerId": 1,
        "date": "2024-07-12"
      }
    ]
  },
  {
    "id": 7,
    "name": "Ruuun",
    "creator": "CherryTeam",
    "verifier": 1,
    "verifyDate": "2025-06-01",
    "completers": [
      {
        "playerId": 1,
        "date": "2025-06-01"
      },
      {
        "playerId": 2,
        "date": "2025-04-08"
      }
    ]
  },
  {
    "id": 8,
    "name": "Ascent",
    "creator": "JustBasic",
    "verifier": 1,
    "verifyDate": "2025-09-18",
    "completers": [
      {
        "playerId": 1,
        "date": "2025-09-18"
      }
    ]
  },
  {
    "id": 9,
    "name": "Necropolis",
    "creator": "IIINepTuneIII",
    "verifier": 3,
    "verifyDate": "2025-11-10",
    "completers": [
      {
        "playerId": 3,
        "date": "2025-11-10"
      }
    ]
  },
  {
    "id": 10,
    "name": "Acu",
    "creator": "Neigefeu",
    "verifier": 1,
    "verifyDate": "2025-11-10",
    "completers": [
      {
        "playerId": 1,
        "date": "2025-11-10"
      }
    ]
  },
  {
    "id": 11,
    "name": "Windy Landscape",
    "creator": "WOOGI1411",
    "verifier": 3,
    "verifyDate": "2025-11-11",
    "completers": [
      {
        "playerId": 3,
        "date": "2025-11-11"
      }
    ]
  }
];

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–º–æ–Ω–∞ –ø–æ ID
function getDemonById(id) {
    return demons.find(demon => demon.id === id);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –¥–µ–º–æ–Ω–æ–≤
function getAllDemons() {
    return demons;
}



–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: futuredemons.js
const futureDemons = [
  {
    "id": 1,
    "name": "Void Wave",
    "creator": "CherryTeam",
    "difficulty": "Extreme Demon",
    "description": "–î–ª–∏–Ω–Ω—ã–π –∏ –æ—á–µ–Ω—å –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Å —Å–ª–æ–∂–Ω—ã–º –≥–µ–π–º–ø–ª–µ–µ–º –ª–æ—É-—ç–∫—Å—Ç—Ä–∏–º–∞.",
    "beatingPlayers": [
      {
        "playerId": 1,
        "progress": 39,
        "lastUpdate": "2025-09-25"
      }
    ]
  }
];

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞ –ø–æ ID
function getFutureDemonById(id) {
    return futureDemons.find(demon => demon.id === id);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –±—É–¥—É—â–∏—Ö –¥–µ–º–æ–Ω–æ–≤
function getAllFutureDemons() {
    return futureDemons;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤, –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö –¥–µ–º–æ–Ω
function getBeatingPlayers(demonId) {
    const demon = getFutureDemonById(demonId);
    if (!demon) return [];
    
    return demon.beatingPlayers.map(bp => {
        const player = getPlayerById(bp.playerId);
        return {
            ...bp,
            playerName: player ? player.name : 'Unknown'
        };
    }).sort((a, b) => b.progress - a.progress);
}


–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: index.html
<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dolores Squad's Lists</title>
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/modal.css">
    <link rel="stylesheet" href="styles/particles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- –ß–∞—Å—Ç–∏—Ü—ã –Ω–∞ —Ñ–æ–Ω–µ -->
    <div class="particles-background">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>Dolores Squad's Lists</h2>
            </div>
            <div class="nav-menu">
                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ -->
                <a href="#/" class="nav-link">Main</a>
                <a href="#/demons" class="nav-link">Demonlist</a>
                <a href="#/players" class="nav-link">Players list</a>
                <a href="#/future" class="nav-link">Future Demon</a>
                <a href="#/rules" class="nav-link">Rules</a>
                
                <!-- –ò–∫–æ–Ω–∫–∏ -->
                <div class="nav-icons">
                    <!-- Discord –∫–Ω–æ–ø–∫–∞ -->
                    <button class="discord-btn" title="Discord –°–µ—Ä–≤–µ—Ä">
                        <svg class="discord-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.18.33.25c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"/>
                        </svg>
                    </button>
                    
                    <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
                    <button class="theme-toggle" title="Toggle Theme">
                        <!-- –¢–µ–º–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <main id="app" class="main-content">
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ router -->
    </main>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="demonModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="demonModalContent"></div>
        </div>
    </div>

    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="playerModalContent"></div>
        </div>
    </div>

    <div id="futureDemonModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="futureDemonModalContent"></div>
        </div>
    </div>

    <script src="js/list.js"></script>
    <script src="js/demons.js"></script>
    <script src="js/players.js"></script>
    <script src="js/futuredemons.js"></script>
    <script src="js/routers.js"></script>
    <script src="js/main.js"></script>
</body>
</html>

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: list.js
// –†–∞—Å—á–µ—Ç –æ—á–∫–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω–æ–≤
function calculateDemonPoints(position) {
    const basePoints = 500;
    const decayRate = 0.19; // 19%
    
    if (position === 1) return basePoints;
    
    let points = basePoints;
    for (let i = 2; i <= position; i++) {
        points = points * (1 - decayRate);
    }
    
    return Math.round(points);
}

// –î–õ–Ø –î–û–õ–û–†–ï–°–ê (–†–ê–°–°–¢–ê–í–õ–ï–ù–ò–ï –¢–û–ü–ê)


const demonList = [10, 1, 9, 2, 3, 11, 4, 5, 6, 7, 8];


// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ø–∞ –¥–µ–º–æ–Ω–æ–≤ —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –æ—á–∫–∞–º–∏
function getDemonLeaderboard() {
    return demonList.map((demonId, index) => {
        const demon = getDemonById(demonId);
        const position = index + 1;
        const points = calculateDemonPoints(position);
        
        return {
            ...demon,
            position: position,
            points: points
        };
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ø–∞ –∏–≥—Ä–æ–∫–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ –æ—á–∫–∞–º)
function getPlayerLeaderboard() {
    const allPlayers = getAllPlayers();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏ –∫–∞–∂–¥–æ–º—É –∏–≥—Ä–æ–∫—É
    const playersWithPoints = allPlayers.map(player => ({
        ...player,
        points: calculatePlayerPoints(player.id)
    }));
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –æ—á–∫–∞–º (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
    return playersWithPoints
        .sort((a, b) => b.points - a.points)
        .map((player, index) => ({
            ...player,
            position: index + 1
        }));
}

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: main.js
// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏
function initTheme() {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.documentElement.setAttribute('data-theme', savedTheme);
    
    const themeToggle = document.querySelector('.theme-toggle');
    themeToggle.innerHTML = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    themeToggle.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É';
    
    themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        themeToggle.innerHTML = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        localStorage.setItem('theme', newTheme);
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ Discord
function initDiscordButton() {
    const discordBtn = document.querySelector('.discord-btn');
    
    discordBtn.addEventListener('click', () => {
        // –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ—é Discord —Å—Å—ã–ª–∫—É
        window.open('https://discord.gg/v8aZ5HYXCC', '_blank');
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
function initModals() {
    const demonModal = document.getElementById('demonModal');
    const playerModal = document.getElementById('playerModal');
    const futureDemonModal = document.getElementById('futureDemonModal');
    const closeButtons = document.querySelectorAll('.close');
    
    const closeModal = () => {
        demonModal.style.display = 'none';
        playerModal.style.display = 'none';
        futureDemonModal.style.display = 'none';
        document.body.style.overflow = 'auto';
        document.body.style.paddingRight = '0';
    };
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫—Ä–µ—Å—Ç–∏–∫
    closeButtons.forEach(button => {
        button.addEventListener('click', closeModal);
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    window.addEventListener('click', (event) => {
        if (event.target === demonModal || event.target === playerModal || event.target === futureDemonModal) {
            closeModal();
        }
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
    document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
            closeModal();
        }
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–µ–º–æ–Ω–∞
function openDemonModal(demonId) {
    const demon = getDemonById(demonId);
    if (!demon) return;
    
    const demonPosition = demonList.indexOf(demonId) + 1;
    const demonPoints = calculateDemonPoints(demonPosition);
    
    const verifierPlayer = getPlayerById(demon.verifier);
    const verifierName = verifierPlayer ? verifierPlayer.name : 'Unknown';
    
    const completersHTML = demon.completers.map(completer => {
        const player = getPlayerById(completer.playerId);
        return player ? `
            <div class="completer-item">
                <span class="completer-name">${player.name}</span>
                <span class="completer-date">${formatDate(completer.date)}</span>
            </div>
        ` : '';
    }).join('');
    
    const modalContent = document.getElementById('demonModalContent');
    modalContent.innerHTML = `
        <div class="demon-modal-header">
            <h2 class="demon-modal-name">${demon.name}</h2>
            <div class="demon-modal-creator">Creator: ${demon.creator}</div>
        </div>
        
        <div class="demon-modal-stats">
            <div class="stat-item">
                <div class="stat-label">Placement</div>
                <div class="stat-value">#${demonPosition}</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Points</div>
                <div class="stat-value">${demonPoints}</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Victors</div>
                <div class="stat-value">${demon.completers.length} –∏–≥—Ä–æ–∫–æ–≤</div>
            </div>
        </div>
        
        <div class="verifier-info">
            <div class="verifier-label">Verifier</div>
            <div class="verifier-name">${verifierName}</div>
            <div class="verifier-date">${formatDate(demon.verifyDate)}</div>
        </div>
        
        <div class="completers-section">
            <h3 class="completers-title">All victors</h3>
            <div class="completers-list-container">
                <div class="completers-list">
                    ${completersHTML}
                </div>
            </div>
        </div>
    `;
    
    document.getElementById('demonModal').style.display = 'block';
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–≥—Ä–æ–∫–∞
function openPlayerModal(playerId) {
    const player = getPlayerById(playerId);
    if (!player) return;
    
    const playerPoints = calculatePlayerPoints(playerId);
    const playerDemons = getPlayerDemons(playerId);
    
    const demonsHTML = playerDemons.map(demon => {
        const demonPosition = demonList.indexOf(demon.id) + 1;
        const demonPoints = calculateDemonPoints(demonPosition);
        return `
            <div class="demon-card" data-demon-id="${demon.id}">
                <div class="demon-card-name">${demon.name}</div>
                <div class="demon-card-rank">#${demonPosition} ‚Ä¢ ${demonPoints} points</div>
            </div>
        `;
    }).join('');
    
    const modalContent = document.getElementById('playerModalContent');
    modalContent.innerHTML = `
        <div class="player-modal-header">
            <h2 class="player-modal-name">${player.name}</h2>
        </div>
        
        <div class="player-modal-stats">
            <div class="stat-item">
                <div class="stat-label">All points</div>
                <div class="stat-value">${playerPoints}</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Demons beated</div>
                <div class="stat-value">${player.completedDemons.length}</div>
            </div>
        </div>
        
        <div class="demons-completed-section">
            <h3 class="demons-completed-title">Demons beated</h3>
            <div class="demons-grid-container">
                <div class="demons-grid">
                    ${demonsHTML}
                </div>
            </div>
        </div>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–µ–º–æ–Ω–æ–≤
    setTimeout(() => {
        document.querySelectorAll('#playerModalContent .demon-card').forEach(card => {
            card.addEventListener('click', () => {
                const demonId = parseInt(card.getAttribute('data-demon-id'));
                document.getElementById('playerModal').style.display = 'none';
                openDemonModal(demonId);
            });
        });
    }, 0);
    
    document.getElementById('playerModal').style.display = 'block';
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –±—É–¥—É—â–µ–≥–æ –¥–µ–º–æ–Ω–∞
function openFutureDemonModal(demonId) {
    const demon = getFutureDemonById(demonId);
    if (!demon) return;
    
    const beatingPlayers = getBeatingPlayers(demonId);
    
    const playersHTML = beatingPlayers.map(bp => `
        <div class="beating-player-modal">
            <div class="player-progress-modal">
                <div class="progress-info-modal">
                    <span class="player-name">${bp.playerName}</span>
                    <span class="progress-percent">${bp.progress}%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" style="width: ${bp.progress}%"></div>
                </div>
            </div>
            <div class="last-update">${formatDate(bp.lastUpdate)}</div>
        </div>
    `).join('');
    
    const modalContent = document.getElementById('futureDemonModalContent');
    modalContent.innerHTML = `
        <div class="demon-modal-header">
            <h2 class="demon-modal-name">${demon.name}</h2>
            <div class="demon-modal-creator">–°–æ–∑–¥–∞—Ç–µ–ª—å: ${demon.creator}</div>
            <div style="margin-top: 10px;">
                <span class="difficulty-badge">${demon.difficulty}</span>
            </div>
        </div>
        
        <div class="future-demon-modal-stats">
            <div class="stat-item">
                <div class="stat-label">Players beating</div>
                <div class="stat-value">${demon.beatingPlayers.length}</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Highest run</div>
                <div class="stat-value">${Math.max(...demon.beatingPlayers.map(bp => bp.progress))}%</div>
            </div>
        </div>
        
        <div class="demon-description">
            <div class="description-label">Description</div>
            <div class="description-text">${demon.description}</div>
        </div>
        
        <div class="beating-players-section">
            <h3 class="beating-players-title">Players who would be the victor</h3>
            <div class="beating-players-container">
                <div class="beating-players-list">
                    ${playersHTML}
                </div>
            </div>
        </div>
    `;
    
    document.getElementById('futureDemonModal').style.display = 'block';
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã
function formatDate(dateString) {
    if (!dateString) return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
    
    try {
        const options = { year: 'numeric', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString('ru-RU', options);
    } catch (error) {
        return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
    }
}
// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
function getTotalPlayers() {
    return getAllPlayers().length;
}

function getTotalDemons() {
    return getAllDemons().length;
}

function getTotalFutureDemons() {
    return getAllFutureDemons().length;
}

function getTotalCompletions() {
    let total = 0;
    getAllDemons().forEach(demon => {
        total += demon.completers.length;
    });
    return total;
}

function getAverageCompletionsPerDemon() {
    const demons = getAllDemons();
    if (demons.length === 0) return 0;
    
    const totalCompletions = getTotalCompletions();
    return Math.round(totalCompletions / demons.length);
}

function getMostCompletedDemon() {
    const demons = getAllDemons();
    if (demons.length === 0) return null;
    
    return demons.reduce((max, demon) => {
        return demon.completers.length > max.completers.length ? demon : max;
    });
}

function getPlayerWithMostPoints() {
    const players = getAllPlayers();
    if (players.length === 0) return null;
    
    return players.reduce((max, player) => {
        const playerPoints = calculatePlayerPoints(player.id);
        const maxPoints = calculatePlayerPoints(max.id);
        return playerPoints > maxPoints ? player : max;
    });
}

function getRecentCompletions() {
    let allCompletions = [];
    
    getAllDemons().forEach(demon => {
        demon.completers.forEach(completer => {
            allCompletions.push({
                playerName: getPlayerById(completer.playerId)?.name || 'Unknown',
                demonName: demon.name,
                date: completer.date
            });
        });
    });
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
    return allCompletions.sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
}

function getDemonWithHighestPoints() {
    const leaderboard = getDemonLeaderboard();
    return leaderboard[0]; // –ü–µ—Ä–≤—ã–π –¥–µ–º–æ–Ω –≤ —Ç–æ–ø–µ
}

function getTotalPointsDistributed() {
    let total = 0;
    getAllPlayers().forEach(player => {
        total += calculatePlayerPoints(player.id);
    });
    return total;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', () => {
    initTheme();
    initModals();
    initDiscordButton();
    console.log('GD Demonlist initialized successfully!');
});

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: modal.css
:root {
    --modal-bg: #1a1a1a;
    --modal-border: #333;
    --modal-text: #ffffff;
    --modal-secondary: #888;
}

[data-theme="light"] {
    --modal-bg: #ffffff;
    --modal-border: #e2e8f0;
    --modal-text: #2d3748;
    --modal-secondary: #718096;
}


.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    overflow-y: auto;
    padding: 20px 0;
}


.modal-content {
    background: var(--modal-bg);
    margin: 2% auto;
    padding: 2rem;
    border-radius: 12px;
    width: 90%;
    max-width: 500px;
    border: 1px solid var(--modal-border);
    position: relative;
    color: var(--modal-text);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    /* –£–±–∏—Ä–∞–µ–º –æ–±—â–∏–π —Å–∫—Ä–æ–ª–ª —É –º–æ–¥–∞–ª–∫–∏ */
    overflow: visible;
    max-height: none;
}

.close {
    color: var(--modal-secondary);
    float: right;
    font-size: 1.5rem;
    font-weight: bold;
    cursor: pointer;
    position: absolute;
    right: 1rem;
    top: 1rem;
    background: none;
    border: none;
    z-index: 1001;
}

.close:hover {
    color: var(--modal-text);
}

/* –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
.demon-modal-header,
.player-modal-header {
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--modal-border);
}

.demon-modal-name {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: #ffffff;
}

.demon-modal-creator {
    color: var(--modal-secondary);
    font-size: 1rem;
}

.player-modal-name {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: #ffffff;

}

/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
.demon-modal-stats,
.player-modal-stats,
.future-demon-modal-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.stat-item {
    background: var(--bg-card);
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
    border: 1px solid var(--modal-border);
}

.stat-label {
    color: var(--modal-secondary);
    font-size: 0.8rem;
    margin-bottom: 0.25rem;
}

.stat-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--modal-text);
}

/* –í–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä */
.verifier-info {
    background: var(--bg-secondary);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    border-left: 4px solid var(--accent-primary);
}

.verifier-label {
    color: var(--modal-secondary);
    font-size: 0.8rem;
    margin-bottom: 0.25rem;
}

.verifier-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--accent-primary);
}

/* –°–ø–∏—Å–∫–∏ - –¢–û–õ–¨–ö–û –ó–î–ï–°–¨ –°–ö–†–û–õ–õ */
.completers-section,
.demons-completed-section,
.beating-players-section {
    margin-top: 1.5rem;
}

.completers-title,
.demons-completed-title,
.beating-players-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--modal-text);
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞ */
.completers-list-container,
.demons-grid-container,
.beating-players-container {
    max-height: 250px;
    overflow-y: auto;
    border: 1px solid var(--modal-border);
    border-radius: 8px;
    background: var(--bg-card);
}

.completers-list {
    display: flex;
    flex-direction: column;
    padding: 0.5rem;
}

.completer-item {
    padding: 0.75rem;
    border-radius: 6px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background 0.2s ease;
}

.completer-item:hover {
    background: var(--bg-secondary);
}

.completer-item:not(:last-child) {
    border-bottom: 1px solid var(--modal-border);
}

.completer-name {
    font-weight: 500;
    color: var(--modal-text);
}

.completer-date {
    color: var(--modal-secondary);
    font-size: 0.8rem;
}

/* –°–µ—Ç–∫–∞ –¥–µ–º–æ–Ω–æ–≤ */
.demons-grid-container {
    padding: 0.5rem;
}

.demons-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 0.75rem;
}

.demon-card {
    background: var(--bg-card);
    padding: 1rem;
    border-radius: 8px;
    cursor: pointer;
    border: 1px solid var(--modal-border);
    text-align: center;
    transition: all 0.2s ease;
}

.demon-card:hover {
    border-color: var(--accent-primary);
    transform: translateY(-2px);
}

.demon-card-name {
    font-weight: 600;
    margin-bottom: 0.25rem;
    color: var(--accent-primary);
    font-size: 0.9rem;
}

.demon-card-rank {
    color: var(--modal-secondary);
    font-size: 0.8rem;
}

/* –ë—É–¥—É—â–∏–µ –¥–µ–º–æ–Ω—ã */
.difficulty-badge {
    background: var(--accent-future);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    display: inline-block;
    margin-top: 0.5rem;
}

.beating-players-container {
    padding: 0.5rem;
}

.beating-players-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.beating-player-modal {
    background: var(--bg-card);
    padding: 1rem;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 1rem;
    border: 1px solid var(--modal-border);
}

.player-progress-modal {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-grow: 1;
}

.progress-info-modal {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    min-width: 120px;
}

.progress-bar-container {
    flex-grow: 1;
    background: var(--modal-border);
    height: 6px;
    border-radius: 3px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background: var(--accent-future);
    border-radius: 3px;
}

.last-update {
    color: var(--modal-secondary);
    font-size: 0.8rem;
}

/* –û–ø–∏—Å–∞–Ω–∏–µ */
.demon-description {
    background: var(--bg-secondary);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    border-left: 4px solid var(--accent-future);
}

.description-label {
    color: var(--modal-secondary);
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
}

.description-text {
    color: var(--modal-text);
    line-height: 1.5;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ - —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å–ø–∏—Å–∫–æ–≤ */
.completers-list-container::-webkit-scrollbar,
.demons-grid-container::-webkit-scrollbar,
.beating-players-container::-webkit-scrollbar {
    width: 6px;
}

.completers-list-container::-webkit-scrollbar-track,
.demons-grid-container::-webkit-scrollbar-track,
.beating-players-container::-webkit-scrollbar-track {
    background: var(--bg-secondary);
    border-radius: 3px;
}

.completers-list-container::-webkit-scrollbar-thumb,
.demons-grid-container::-webkit-scrollbar-thumb,
.beating-players-container::-webkit-scrollbar-thumb {
    background: var(--accent-primary);
    border-radius: 3px;
}

.completers-list-container::-webkit-scrollbar-thumb:hover,
.demons-grid-container::-webkit-scrollbar-thumb:hover,
.beating-players-container::-webkit-scrollbar-thumb:hover {
    background: var(--accent-secondary);
}

/* –î–ª—è Firefox */
.completers-list-container,
.demons-grid-container,
.beating-players-container {
    scrollbar-width: thin;
    scrollbar-color: var(--accent-primary) var(--bg-secondary);
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–∞–ª–æ–∫ */
@media (max-width: 768px) {
    .modal-content {
        margin: 5% auto;
        padding: 1.5rem;
        width: 95%;
    }

    .demons-grid {
        grid-template-columns: 1fr;
    }

    .beating-player-modal {
        flex-direction: column;
        gap: 0.75rem;
    }

    .player-progress-modal {
        width: 100%;
    }

    .progress-info-modal {
        width: 100%;
        justify-content: space-between;
    }

    .completers-list-container,
    .demons-grid-container,
    .beating-players-container {
        max-height: 200px;
    }
}

@media (max-width: 480px) {
    .modal-content {
        margin: 2% auto;
        padding: 1rem;
    }
    
    .completers-list-container,
    .demons-grid-container,
    .beating-players-container {
        max-height: 180px;
    }
}

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: particles.css
.particles-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    overflow: hidden;
    pointer-events: none;
}

.particle {
    position: absolute;
    border-radius: 50%;
    animation: float 20s infinite linear;
    opacity: 0;
}

/* –ß–∞—Å—Ç–∏—Ü—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏ –∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ */
.particle:nth-child(1) {
    width: 4px;
    height: 4px;
    background: rgba(255, 71, 87, 0.4);
    top: 10%;
    left: 20%;
    animation-duration: 25s;
    animation-delay: 0s;
}

.particle:nth-child(2) {
    width: 6px;
    height: 6px;
    background: rgba(55, 66, 250, 0.3);
    top: 60%;
    left: 80%;
    animation-duration: 20s;
    animation-delay: 2s;
}

.particle:nth-child(3) {
    width: 3px;
    height: 3px;
    background: rgba(34, 193, 195, 0.5);
    top: 80%;
    left: 40%;
    animation-duration: 30s;
    animation-delay: 4s;
}

.particle:nth-child(4) {
    width: 5px;
    height: 5px;
    background: rgba(255, 165, 2, 0.4);
    top: 30%;
    left: 10%;
    animation-duration: 22s;
    animation-delay: 1s;
}

.particle:nth-child(5) {
    width: 4px;
    height: 4px;
    background: rgba(0, 255, 136, 0.3);
    top: 50%;
    left: 90%;
    animation-duration: 28s;
    animation-delay: 3s;
}

.particle:nth-child(6) {
    width: 7px;
    height: 7px;
    background: rgba(255, 71, 87, 0.2);
    top: 15%;
    left: 70%;
    animation-duration: 24s;
    animation-delay: 5s;
}

.particle:nth-child(7) {
    width: 3px;
    height: 3px;
    background: rgba(55, 66, 250, 0.4);
    top: 75%;
    left: 15%;
    animation-duration: 26s;
    animation-delay: 2s;
}

.particle:nth-child(8) {
    width: 5px;
    height: 5px;
    background: rgba(34, 193, 195, 0.3);
    top: 40%;
    left: 60%;
    animation-duration: 32s;
    animation-delay: 6s;
}

.particle:nth-child(9) {
    width: 4px;
    height: 4px;
    background: rgba(255, 165, 2, 0.5);
    top: 85%;
    left: 85%;
    animation-duration: 21s;
    animation-delay: 4s;
}

.particle:nth-child(10) {
    width: 6px;
    height: 6px;
    background: rgba(0, 255, 136, 0.4);
    top: 25%;
    left: 35%;
    animation-duration: 29s;
    animation-delay: 3s;
}

.particle:nth-child(11) {
    width: 3px;
    height: 3px;
    background: rgba(255, 71, 87, 0.3);
    top: 65%;
    left: 25%;
    animation-duration: 27s;
    animation-delay: 1s;
}

.particle:nth-child(12) {
    width: 5px;
    height: 5px;
    background: rgba(55, 66, 250, 0.4);
    top: 45%;
    left: 75%;
    animation-duration: 23s;
    animation-delay: 5s;
}

.particle:nth-child(13) {
    width: 4px;
    height: 4px;
    background: rgba(34, 193, 195, 0.3);
    top: 20%;
    left: 50%;
    animation-duration: 31s;
    animation-delay: 7s;
}

.particle:nth-child(14) {
    width: 6px;
    height: 6px;
    background: rgba(255, 165, 2, 0.4);
    top: 70%;
    left: 45%;
    animation-duration: 26s;
    animation-delay: 2s;
}

.particle:nth-child(15) {
    width: 3px;
    height: 3px;
    background: rgba(0, 255, 136, 0.5);
    top: 35%;
    left: 30%;
    animation-duration: 24s;
    animation-delay: 4s;
}

@keyframes float {
    0% {
        transform: translateY(100vh) translateX(-50px) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: 0.6;
    }
    50% {
        opacity: 0.8;
    }
    90% {
        opacity: 0.4;
    }
    100% {
        transform: translateY(-100px) translateX(50px) rotate(360deg);
        opacity: 0;
    }
}

/* –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã */
[data-theme="light"] .particle {
    background: rgba(0, 0, 0, 0.1);
}

[data-theme="light"] .particle:nth-child(1) {
    background: rgba(220, 53, 69, 0.3);
}

[data-theme="light"] .particle:nth-child(2) {
    background: rgba(13, 110, 253, 0.2);
}

[data-theme="light"] .particle:nth-child(3) {
    background: rgba(32, 201, 151, 0.3);
}

[data-theme="light"] .particle:nth-child(4) {
    background: rgba(253, 126, 20, 0.3);
}

[data-theme="light"] .particle:nth-child(5) {
    background: rgba(0, 204, 102, 0.2);
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
@media (max-width: 768px) {
    .particles-background {
        display: none; /* –û—Ç–∫–ª—é—á–∞–µ–º —á–∞—Å—Ç–∏—Ü—ã –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ */
    }
}

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: particles-config.js
document.addEventListener('DOMContentLoaded', function() {
    particlesJS('particles-js', {
        particles: {
            number: {
                value: 80,
                density: {
                    enable: true,
                    value_area: 800
                }
            },
            color: {
                value: ['#ff4757', '#3742fa', '#22c1c3', '#ffa502']
            },
            shape: {
                type: 'circle',
                stroke: {
                    width: 0,
                    color: '#000000'
                }
            },
            opacity: {
                value: 0.3,
                random: true,
                anim: {
                    enable: true,
                    speed: 1,
                    opacity_min: 0.1,
                    sync: false
                }
            },
            size: {
                value: 3,
                random: true,
                anim: {
                    enable: true,
                    speed: 2,
                    size_min: 0.1,
                    sync: false
                }
            },
            line_linked: {
                enable: true,
                distance: 150,
                color: '#ffffff',
                opacity: 0.1,
                width: 1
            },
            move: {
                enable: true,
                speed: 1,
                direction: 'none',
                random: true,
                straight: false,
                out_mode: 'out',
                bounce: false,
                attract: {
                    enable: false,
                    rotateX: 600,
                    rotateY: 1200
                }
            }
        },
        interactivity: {
            detect_on: 'canvas',
            events: {
                onhover: {
                    enable: true,
                    mode: 'repulse'
                },
                onclick: {
                    enable: true,
                    mode: 'push'
                },
                resize: true
            }
        },
        retina_detect: true
    });
});

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: players.js
const players = [
  {
    "id": 1,
    "name": "DoloresKingGMD",
    "completedDemons": [
      10,
      1,
      2,
      4,
      5,
      6,
      7,
      8
    ]
  },
  {
    "id": 2,
    "name": "Walen0k",
    "completedDemons": [
      3,
      7
    ]
  },
  {
    "id": 3,
    "name": "What",
    "completedDemons": [
      1,
      2,
      3,
      9,
      11

    ]
  }
];

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –ø–æ ID
function getPlayerById(id) {
    return players.find(player => player.id === id);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
function getAllPlayers() {
    return players;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–º–æ–Ω–æ–≤ –∏–≥—Ä–æ–∫–∞
function getPlayerDemons(playerId) {
    const player = getPlayerById(playerId);
    if (!player) return [];
    
    return player.completedDemons.map(demonId => {
        const demon = getDemonById(demonId);
        return {
            ...demon,
            completionDate: getCompletionDate(playerId, demonId)
        };
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞—Ç—ã –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–µ–º–æ–Ω–∞ –∏–≥—Ä–æ–∫–æ–º
function getCompletionDate(playerId, demonId) {
    const demon = getDemonById(demonId);
    if (!demon) return null;
    
    const completion = demon.completers.find(comp => comp.playerId === playerId);
    return completion ? completion.date : null;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤ –∏–≥—Ä–æ–∫–∞
function calculatePlayerPoints(playerId) {
    const player = getPlayerById(playerId);
    if (!player) return 0;
    
    let totalPoints = 0;
    player.completedDemons.forEach(demonId => {
        const demonIndex = demonList.indexOf(demonId);
        if (demonIndex !== -1) {
            const position = demonIndex + 1;
            totalPoints += calculateDemonPoints(position);
        }
    });
    return totalPoints;
}


–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: routers.js
class Router {
    constructor() {
        this.routes = {
            '/': this.renderHome,
            '/demons': this.renderDemons,
            '/players': this.renderPlayers,
            '/future': this.renderFutureDemons,
            '/rules': this.renderRules
        };
        
        this.init();
    }
    
    init() {
        window.addEventListener('hashchange', () => this.handleRoute());
        window.addEventListener('load', () => this.handleRoute());
    }
    
    handleRoute() {
        const hash = window.location.hash.slice(1) || '/';
        const renderFunction = this.routes[hash];
        
        if (renderFunction) {
            renderFunction.call(this);
            this.updateActiveLink(hash);
        } else {
            this.render404();
        }
    }
    
    updateActiveLink(currentRoute) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –≤ dropdown
        const dropdownLinks = document.querySelectorAll('.dropdown-link');
        dropdownLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${currentRoute}`) {
                link.classList.add('active');
            }
        });
    }
    
    renderHome() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="home-container">
                <h1 class="home-title">Dolores Squad's Lists</h1>
                <p class="home-subtitle">
                Demonlist, Top Players, Future Demons List of Dolores Squad's Community.
                Follow other players' progress, browse the top rankings, and join Dolores Squad!
                </p>
                <div class="home-buttons">
                    <a href="#/demons" class="home-btn btn-demons">Demonlist</a>
                    <a href="#/players" class="home-btn btn-players">Players List</a>
                    <a href="#/future" class="home-btn btn-future">Future Demons</a>
                    <a href="#/rules" class="home-btn btn-rules">Rules</a>
                </div>
                <div class="stats-container">
                    <div class="stat-card">
                        <div>${getAllDemons().length}</div>
                        <div>Demons in ranking</div>
                    </div>
                    <div class="stat-card">
                        <div>${getAllPlayers().length}</div>
                        <div>Players in ranking</div>
                    </div>
                    <div class="stat-card">
                        <div>${getAllFutureDemons().length}</div>
                        <div>Future Demons</div>
                    </div>
                </div>
            </div>
        `;
    }
    
renderDemons() {
    const leaderboard = getDemonLeaderboard();
    const demonsHTML = leaderboard.map(demon => `
        <div class="demon-item" data-demon-id="${demon.id}">
            <div class="demon-rank">#${demon.position}</div>
            <div class="demon-info">
                <div class="demon-name">${demon.name}</div>
                <div class="demon-creator">by ${demon.creator}</div>
            </div>
            <div class="demon-points">${demon.points} pts</div>
        </div>
    `).join('');
    
    const app = document.getElementById('app');
    app.innerHTML = `
        <div class="demons-container">
            <h1 class="page-title">Demonlist</h1>
            <div class="demons-list">
                ${demonsHTML}
            </div>
        </div>
    `;
    
    document.querySelectorAll('.demon-item').forEach(item => {
        item.addEventListener('click', () => {
            const demonId = parseInt(item.getAttribute('data-demon-id'));
            openDemonModal(demonId);
        });
    });
}

renderPlayers() {
    const leaderboard = getPlayerLeaderboard();
    const playersHTML = leaderboard.map(player => {
        const playerPoints = calculatePlayerPoints(player.id);
        return `
            <div class="player-item" data-player-id="${player.id}">
                <div class="player-rank">#${player.position}</div>
                <div class="player-info">
                    <div class="player-name">${player.name}</div>
                    <div class="player-stats">${player.completedDemons.length} Completed demons</div>
                </div>
                <div class="player-points">${playerPoints} pts</div>
            </div>
        `;
    }).join('');
    
    const app = document.getElementById('app');
    app.innerHTML = `
        <div class="players-container">
            <h1 class="page-title">Players List</h1>
            <div class="players-list">
                ${playersHTML}
            </div>
        </div>
    `;
    
    document.querySelectorAll('.player-item').forEach(item => {
        item.addEventListener('click', () => {
            const playerId = parseInt(item.getAttribute('data-player-id'));
            openPlayerModal(playerId);
        });
    });
}
    
    renderFutureDemons() {
        const futureDemons = getAllFutureDemons();
        const futureDemonsHTML = futureDemons.map(demon => {
            const beatingPlayers = getBeatingPlayers(demon.id);
            const playersHTML = beatingPlayers.map(bp => `
                <div class="beating-player">
                    <div class="player-progress-info">
                        <span class="player-name">${bp.playerName}</span>
                        <span class="progress-percent">${bp.progress}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: ${bp.progress}%"></div>
                    </div>
                </div>
            `).join('');
            
            return `
                <div class="future-demon-item" data-future-demon-id="${demon.id}">
                    <div class="future-demon-header">
                        <div class="future-demon-info">
                            <div class="future-demon-name">${demon.name}</div>
                            <div class="future-demon-creator">by ${demon.creator}</div>
                        </div>
                        <div class="future-demon-difficulty">${demon.difficulty}</div>
                    </div>
                    <div class="beating-players">
                        ${playersHTML}
                    </div>
                </div>
            `;
        }).join('');
        
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="future-demons-container">
                <h1 class="page-title">Future Demons</h1>
                <h3>
                    Levels that can reach the top!
                </h3>
                <div class="future-demons-list">
                    ${futureDemonsHTML}
                </div>
            </div>
        `;
        
        document.querySelectorAll('.future-demon-item').forEach(item => {
            item.addEventListener('click', () => {
                const demonId = parseInt(item.getAttribute('data-future-demon-id'));
                openFutureDemonModal(demonId);
            });
        });
    }
    
    renderRules() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="rules-container">
                <h1 class="page-title">–ü—Ä–∞–≤–∏–ª–∞ –î–µ–º–æ–Ω–ª–∏—Å—Ç–∞</h1>
                <div class="rules-content">
                    <div class="rules-section">
                        <h2>üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–µ–º–æ–Ω–∞–º</h2>
                        <ul class="rules-list">
                            <li>–£—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</li>
                            <li>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞ –≤ –ª–∏—Å—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ—Ç Easy Demon</li>
                            <li>–£—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–π—Ç–Ω—É—Ç</li>
                        </ul>
                    </div>
                    
                    <div class="rules-section">
                        <h2>üéÆ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–≥—Ä–æ–∫–∞–º</h2>
                        <ul class="rules-list">
                            <li>–ß–∏—Ç–µ—Ä—Å—Ç–≤–æ: –õ—é–±–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∏—Ç–æ–≤ –≤–µ–¥–µ—Ç –∫ –±–∞–Ω—É –∏–∑ —Ç–æ–ø–∞</li>
                            <li>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥–æ–≤ —á–µ—Ä–µ–∑ —Å—ã—Ä–æ–µ, –Ω–µ—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ (Google Disk - Yandex Disk)</li>
                            <li>FPS: –†–∞–∑—Ä–µ—à–µ–Ω–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –Ω–∞ –ª—é–±–æ–º FPS, –Ω–æ –±–µ–∑ FPS Bypass (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–∑–∏–∫–∏ 2.1 –≤ –º–æ–¥–µ Click Between Frames —Ç–∞–∫–∂–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ)</li>
                        </ul>
                    </div>
                    
                    <div class="rules-section">
                        <h2>‚≠ê –°–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤</h2>
                        <ul class="rules-list">
                            <li>–ë–∞–∑–æ–≤—ã–µ –æ—á–∫–∏: –¢–æ–ø 1 –¥–µ–º–æ–Ω –¥–∞–µ—Ç 500 –æ—á–∫–æ–≤</li>
                            <li>–£–º–µ–Ω—å—à–µ–Ω–∏–µ: –ö–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è –ø–æ–∑–∏—Ü–∏—è —Ç–µ—Ä—è–µ—Ç 19% –æ—á–∫–æ–≤</li>
                            <li>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –û—á–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–æ–ø–∞</li>
                        </ul>
                    </div>
                    <div class="rules-section">
                        <h2>üìπ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º</h2>
                        <ul class="rules-list">
                            <li>–í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –Ω–∞ Yandex Disk –∏–ª–∏ Doogle Drive –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–µ—Å—å –≥–µ–π–º–ø–ª–µ–π</li>
                            <li>–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª—ã—à–Ω—ã –∫–ª–∏–∫–∏, –ø–æ–∫–∞–∑–∞–Ω—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã FPS, CPS</li>
                            <li>–í–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ 720p –∏–ª–∏ –≤—ã—à–µ</li>
                        </ul>
                    </div>
                </div>
            </div>
                </div>
            </div>
            <div class="rules-container2">
            <div class="rules-content">
                    <div class="rules-section">
                        <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –ø–æ–º–æ—â–∏ –≤ Discord</h2>
                        <ul class="rules-list">
                            <li>Dolores - king5356</li>
                            <li>angyedz - angyedz</li>
                            <li>Wlen0k - looloolloolol</li>
                        </ul>
                    </div>
            
            
            
            
            
            </div>
        `;
    }
    
    render404() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="home-container">
                <h1 class="home-title">404 - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</h1>
                <p class="home-subtitle">
                    –ó–∞–ø—Ä–æ—à–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É.
                </p>
                <div class="home-buttons">
                    <a href="#/" class="home-btn btn-demons">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                </div>
            </div>
        `;
    }
renderHome() {
    const totalPlayers = getTotalPlayers();
    const totalDemons = getTotalDemons();
    const totalFutureDemons = getTotalFutureDemons();
    const totalCompletions = getTotalCompletions();
    const averageCompletions = getAverageCompletionsPerDemon();
    const mostCompletedDemon = getMostCompletedDemon();
    const topPlayer = getPlayerWithMostPoints();
    const topDemon = getDemonWithHighestPoints();
    const totalPoints = getTotalPointsDistributed();
    const recentCompletions = getRecentCompletions();

    const statsHTML = `
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-number">${totalDemons}</div>
                <div class="stat-label">Demons in ranking</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">${totalPlayers}</div>
                <div class="stat-label">Players in ranking</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">${totalFutureDemons}</div>
                <div class="stat-label">Future Demons</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">${totalCompletions}</div>
                <div class="stat-label">All completions</div>
            </div>
        </div>
    `;

    const detailedStatsHTML = `
        <div class="detailed-stats">
            <div class="stats-grid">
                <div class="stat-item-large">
                    <div class="stat-value">${averageCompletions}</div>
                    <div class="stat-label">Average number of beatings per demon</div>
                </div>
                <div class="stat-item-large">
                    <div class="stat-value">${totalPoints}</div>
                    <div class="stat-label">All Points</div>
                </div>
            </div>
            
            ${topPlayer ? `
            <div class="top-player-card">
                <h3>üëë Best Player</h3>
                <div class="player-info">
                    <span class="player-name">${topPlayer.name}</span>
                    <span class="player-points">${calculatePlayerPoints(topPlayer.id)} points</span>
                </div>
                <div class="player-stats">
                    ${topPlayer.completedDemons.length} demons beated
                </div>
            </div>
            ` : ''}
            
            ${topDemon ? `
            <div class="top-demon-card">
                <h3>üî• Top 1 Demon</h3>
                <div class="demon-info">
                    <span class="demon-name">${topDemon.name}</span>
                    <span class="demon-points">${topDemon.points} points</span>
                </div>
                <div class="demon-stats">
                    ${topDemon.completers.length} players beated
                </div>
            </div>
            ` : ''}
            
            ${mostCompletedDemon ? `
            <div class="popular-demon-card">
                <h3>üéØ Most Popular</h3>
                <div class="demon-info">
                    <span class="demon-name">${mostCompletedDemon.name}</span>
                    <span class="completion-count">${mostCompletedDemon.completers.length} completions</span>
                </div>
            </div>
            ` : ''}
        </div>
    `;

    const recentCompletionsHTML = recentCompletions.length > 0 ? `
        <div class="recent-completions">
            <h3>üïê Recent completions</h3>
            <div class="completions-list">
                ${recentCompletions.map(completion => `
                    <div class="completion-item">
                        <span class="player">${completion.playerName}</span>
                        <span class="demon">${completion.demonName}</span>
                        <span class="date">${formatDate(completion.date)}</span>
                    </div>
                `).join('')}
            </div>
        </div>
    ` : '';

    const app = document.getElementById('app');
    app.innerHTML = `
        <div class="home-container">
            <h1 class="home-title">Dolores Squad's Lists</h1>
            <p class="home-subtitle">
            Demonlist, Top Players, Future Demons List of Dolores Squad's Community.
            Follow other players' progress, browse the top rankings, and join Dolores Squad!
            </p>
            <div class="home-buttons">
                <a href="#/demons" class="home-btn btn-demons">Demonlist</a>
                <a href="#/players" class="home-btn btn-players">Players list</a>
                <a href="#/future" class="home-btn btn-future">Future Demons</a>
                <a href="#/rules" class="home-btn btn-rules">Rules</a>
            </div>
            
            ${statsHTML}
            ${detailedStatsHTML}
            ${recentCompletionsHTML}
        </div>
    `;
}
}


const router = new Router();

–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: style.css
:root {
    /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
    --bg-primary: #0f0f0f;
    --bg-secondary: #1a1a1a;
    --bg-tertiary: #252525;
    --text-primary: #ffffff;
    --text-secondary: #b0b0b0;
    --text-accent: #ff4757;
    --accent-primary: #ff4757;
    --accent-secondary: #3742fa;
    --accent-future: #22c1c3;
    --accent-rules: #ffa502;
    --accent-neon: #00ff88;
    --border-color: rgba(255, 255, 255, 0.1);
    --shadow-color: rgba(0, 0, 0, 0.5);
    --card-bg: rgba(255, 255, 255, 0.05);
    --modal-bg: linear-gradient(135deg, #1a1a1a 0%, #252525 100%);
    --nav-bg: rgba(15, 15, 15, 0.95);
}

[data-theme="light"] {
    --bg-primary: #ffffff;
    --bg-secondary: #f8f9fa;
    --bg-tertiary: #e9ecef;
    --text-primary: #212529;
    --text-secondary: #6c757d;
    --text-accent: #dc3545;
    --accent-primary: #dc3545;
    --accent-secondary: #0d6efd;
    --accent-future: #20c997;
    --accent-rules: #fd7e14;
    --accent-neon: #00cc66;
    --border-color: rgba(0, 0, 0, 0.1);
    --shadow-color: rgba(0, 0, 0, 0.1);
    --card-bg: rgba(0, 0, 0, 0.03);
    --modal-bg: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    --nav-bg: rgba(255, 255, 255, 0.95);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}

body {
    font-family: 'Inter', 'Roboto', sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    min-height: 100vh;
    line-height: 1.6;
}

/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
.navbar {
    background: var(--nav-bg);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border-color);
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: 0 4px 30px var(--shadow-color);
}

.nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 80px;
}

.nav-logo h2 {
    background: linear-gradient(45deg, var(--accent-primary), var(--accent-neon));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
    font-size: 2rem;
    letter-spacing: -0.5px;
}

.nav-menu {
    display: flex;
    gap: 10px;
}

.nav-link {
    color: var(--text-secondary);
    text-decoration: none;
    font-weight: 600;
    padding: 12px 24px;
    border-radius: 50px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.nav-link:before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.5s;
}

.nav-link:hover:before {
    left: 100%;
}

.nav-link:hover,
.nav-link.active {
    background: var(--accent-primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255, 71, 87, 0.3);
}

/* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã */
.theme-toggle {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 50px;
    padding: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-left: 20px;
}

.theme-toggle:hover {
    transform: rotate(15deg);
    box-shadow: 0 5px 15px var(--shadow-color);
}

.main-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;
}

/* –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ */
.home-container {
    text-align: center;
    padding: 60px 20px;
}

.home-title {
    font-size: 4rem;
    font-weight: 800;
    margin-bottom: 20px;
    background: linear-gradient(45deg, var(--accent-primary), var(--accent-neon), var(--accent-secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    background-size: 200% 200%;
    animation: gradientShift 3s ease infinite;
}

@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

.home-subtitle {
    font-size: 1.3rem;
    color: var(--text-secondary);
    margin-bottom: 50px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.8;
}

.home-buttons {
    display: flex;
    gap: 20px;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 60px;
}

.home-btn {
    padding: 18px 45px;
    font-size: 1.1rem;
    font-weight: 600;
    text-decoration: none;
    border-radius: 15px;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border: 2px solid transparent;
    position: relative;
    overflow: hidden;
}

.home-btn:before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.home-btn:hover:before {
    left: 100%;
}

.btn-demons {
    background: var(--accent-primary);
    color: white;
    box-shadow: 0 8px 30px rgba(255, 71, 87, 0.3);
}

.btn-demons:hover {
    background: transparent;
    border-color: var(--accent-primary);
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 40px rgba(255, 71, 87, 0.4);
}

.btn-players {
    background: var(--accent-secondary);
    color: white;
    box-shadow: 0 8px 30px rgba(55, 66, 250, 0.3);
}

.btn-players:hover {
    background: transparent;
    border-color: var(--accent-secondary);
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 40px rgba(55, 66, 250, 0.4);
}

.btn-future {
    background: var(--accent-future);
    color: white;
    box-shadow: 0 8px 30px rgba(34, 193, 195, 0.3);
}

.btn-future:hover {
    background: transparent;
    border-color: var(--accent-future);
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 40px rgba(34, 193, 195, 0.4);
    color: var(--accent-future);
}

.btn-rules {
    background: var(--accent-rules);
    color: white;
    box-shadow: 0 8px 30px rgba(255, 165, 2, 0.3);
}

.btn-rules:hover {
    background: transparent;
    border-color: var(--accent-rules);
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 40px rgba(255, 165, 2, 0.4);
    color: var(--accent-rules);
}

/* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü */
.page-title {
    font-size: 3rem;
    text-align: center;
    margin-bottom: 40px;
    background: linear-gradient(45deg, var(--accent-primary), var(--accent-neon));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 700;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∏ –¥–µ–º–æ–Ω–æ–≤ –∏ –∏–≥—Ä–æ–∫–æ–≤ */
.demons-container,
.players-container,
.future-demons-container,
.rules-container {
    max-width: 900px;
    margin: 0 auto;
}
.rules-container2 {
    max-width: 900px;
    margin: 0 auto;
    margin-top: 10px;
}

.demons-list,
.players-list,
.future-demons-list {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-top: 15px; /* —Å–≤–µ—Ä—Ö—É */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –¥–µ–º–æ–Ω–æ–≤ */
.demon-item {
    background: linear-gradient(45deg, #ff73730e, #00ffee0a);;
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: var(--card-shadow);
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* –ú–µ–Ω—è–µ–º –Ω–∞ flex-start –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –ø–æ –≤–µ—Ä—Ö—É */
    gap: 1rem;
}

.demon-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
    border-color: var(--accent-primary);
}

.demon-rank {
    font-size: 1.25rem;
    font-weight: 700;
    min-width: 50px;
    color: var(--accent-primary);
    text-align: center;
    margin-top: 0.25rem; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º */
}

.demon-info {
    flex-grow: 1;
    min-width: 0;
}

.demon-name {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 0.5rem; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.2;
}

.demon-creator {
    color: var(--text-secondary);
    font-size: 0.9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
    margin-top: 0.25rem; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
}

.demon-points {
    font-weight: 700;
    color: var(--text-accent);
    font-size: 1rem;
    min-width: 80px;
    text-align: right;
    margin-top: 0.25rem; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤ */
.player-item {
    background: linear-gradient(45deg, #3426ff11, #ff3b3b0a);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: var(--card-shadow);
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* –ú–µ–Ω—è–µ–º –Ω–∞ flex-start –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –ø–æ –≤–µ—Ä—Ö—É */
    gap: 1rem;
}

.player-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
    border-color: var(--accent-secondary);
}

.player-rank {
    font-size: 1.25rem;
    font-weight: 700;
    min-width: 50px;
    color: var(--accent-secondary);
    text-align: center;
    margin-top: 0.25rem; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è —Å –∏–º–µ–Ω–µ–º */
}

.player-info {
    flex-grow: 1;
    min-width: 0;
}

.player-name {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 0.5rem; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.2;
}

.player-stats {
    color: var(--text-secondary);
    font-size: 0.9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
    margin-top: 0.25rem; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
}

.player-points {
    font-weight: 700;
    color: var(--text-accent);
    font-size: 1rem;
    min-width: 80px;
    text-align: right;
    margin-top: 0.25rem; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è */
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
@media (max-width: 768px) {
    .demon-item,
    .player-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
        padding: 1rem;
    }
    
    .demon-rank,
    .player-rank {
        align-self: flex-start;
        text-align: left;
        margin-top: 0;
    }
    
    .demon-points,
    .player-points {
        align-self: flex-start;
        text-align: left;
        margin-top: 0;
    }
    
    .demon-info,
    .player-info {
        width: 100%;
    }
    
    .demon-name,
    .player-name {
        margin-bottom: 0.25rem; /* –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
    }
    
    .demon-creator,
    .player-stats {
        margin-top: 0.125rem; /* –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
    }
}

@media (max-width: 480px) {
    .demon-name,
    .player-name {
        font-size: 1.1rem;
        margin-bottom: 0.2rem;
    }
    
    .demon-creator,
    .player-stats {
        font-size: 0.8rem;
        margin-top: 0.1rem;
    }
}

.demon-points,
.player-points {
    font-weight: 700;
    color: var(--accent-neon);
    font-size: 1.2rem;
    font-weight: 800;
}

/* –ë—É–¥—É—â–∏–µ –¥–µ–º–æ–Ω—ã */
.future-demon-item {
    border: 1px solid #2a2a2a8c;
    border-radius: 14px;
    padding: 20px;
    background: radial-gradient(circle, rgba(0, 255, 221, 0.2) 0%, );;
    backdrop-filter: blur(10px);
    transition: 
        transform 0.8s cubic-bezier(0.23, 1, 0.32, 1),
        box-shadow 0.6s cubic-bezier(0.23, 1, 0.32, 1),
        border-color 0.4s ease,
        background-color 1s ease;
    position: relative;
}

.future-demon-item:hover {
    border-color: #00ffdd;
    background-color: linear-gradient(45deg, #d8d8d8, #4ecdc557);
    box-shadow: 
        0 10px 20px rgba(0, 255, 221, 0.2),
        0 5px 15px rgba(0, 123, 255, 0.3),
        0 0 0 1px rgba(0, 255, 221, 0.1);
    transform: 
        translateY(-5px) 
        perspective(1000px) 
        rotateX(2deg) 
        scale(1.02);
}

.future-demon-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
}

.future-demon-info {
    flex-grow: 1;
}

.future-demon-name {
    font-size: 1.4rem;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--accent-future);
}

.future-demon-creator {
    color: var(--text-secondary);
    font-size: 1rem;
}

.future-demon-difficulty {
    background: linear-gradient(45deg, var(--accent-future), var(--accent-neon));
    padding: 8px 16px;
    border-radius: 25px;
    font-size: 0.9rem;
    font-weight: 600;
    color: black;
}

.beating-players {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.beating-player {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 12px;
    background: var(--bg-tertiary);
    border-radius: 12px;
    transition: all 0.3s ease;
}

.beating-player:hover {
    transform: translateX(5px);
    box-shadow: 0 5px 15px var(--shadow-color);
}

.player-progress-info {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 140px;
}

.player-name {
    font-weight: 600;
    color: var(--accent-future);
}

.progress-percent {
    color: var(--accent-neon);
    font-weight: 700;
    min-width: 50px;
    font-size: 1.1rem;
}

.progress-bar-container {
    flex-grow: 1;
    background: var(--bg-tertiary);
    height: 10px;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: inset 0 2px 4px var(--shadow-color);
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-future), var(--accent-neon));
    border-radius: 8px;
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.progress-bar:after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% { left: -100%; }
    100% { left: 100%; }
}

/* –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∞–≤–∏–ª */
.rules-content {
    background: var(--card-bg);
    border-radius: 25px;
    padding: 40px;
    backdrop-filter: blur(10px);
    border: 1px solid var(--border-color);
}

.rules-section {
    margin-bottom: 40px;
}

.rules-section:last-child {
    margin-bottom: 0;
}

.rules-section h2 {
    color: var(--accent-primary);
    margin-bottom: 20px;
    font-size: 1.8rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
}

.rules-list {
    list-style: none;
    padding: 0;
}

.rules-list li {
    padding: 15px 0;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: flex-start;
    gap: 15px;
    transition: all 0.3s ease;
}

.rules-list li:hover {
    background: var(--bg-tertiary);
    margin: 0 -15px;
    padding: 15px;
    border-radius: 12px;
}

.rules-list li:before {
    content: "‚ñ∏";
    color: var(--accent-neon);
    font-weight: bold;
    font-size: 1.3rem;
    margin-top: 2px;
}

.rules-list li:last-child {
    border-bottom: none;
}

.rule-category {
    color: var(--accent-rules);
    font-weight: 600;
    min-width: 140px;
    font-size: 1rem;
}

.rule-description {
    color: var(--text-primary);
    flex-grow: 1;
    line-height: 1.6;
}

/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π */
.stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
    margin-top: 60px;
}

.stat-card {
    background: var(--card-bg);
    padding: 30px;
    border-radius: 20px;
    text-align: center;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 40px var(--shadow-color);
}

.stat-card:nth-child(1) {
    border-top: 4px solid var(--accent-primary);
}

.stat-card:nth-child(2) {
    border-top: 4px solid var(--accent-secondary);
}

.stat-card:nth-child(3) {
    border-top: 4px solid var(--accent-future);
}

.stat-card div:first-child {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 10px;
}

.stat-card:nth-child(1) div:first-child {
    background: linear-gradient(45deg, var(--accent-primary), var(--accent-neon));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.stat-card:nth-child(2) div:first-child {
    background: linear-gradient(45deg, var(--accent-secondary), var(--accent-neon));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.stat-card:nth-child(3) div:first-child {
    background: linear-gradient(45deg, var(--accent-future), var(--accent-neon));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.stat-card div:last-child {
    color: var(--text-secondary);
    font-size: 1.1rem;
    font-weight: 500;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
    .nav-container {
        flex-direction: column;
        height: auto;
        padding: 15px 20px;
    }

    .nav-menu {
        margin-top: 15px;
        gap: 8px;
        flex-wrap: wrap;
        justify-content: center;
    }

    .home-title {
        font-size: 2.5rem;
    }

    .home-buttons {
        flex-direction: column;
        align-items: center;
    }

    .home-btn {
        width: 100%;
        max-width: 300px;
    }

    .demon-item,
    .player-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .demon-rank,
    .player-rank {
        align-self: flex-start;
    }

    .future-demon-header {
        flex-direction: column;
        gap: 15px;
    }

    .beating-player {
        flex-direction: column;
        gap: 12px;
    }

    .player-progress-info {
        min-width: auto;
        width: 100%;
        justify-content: space-between;
    }

    .rules-list li {
        flex-direction: column;
        gap: 8px;
    }

    .rule-category {
        min-width: auto;
    }

    .stats-container {
        grid-template-columns: 1fr;
    }
}

/* –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è flex */
.demon-item,
.player-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
/* –î–æ–±–∞–≤—å —ç—Ç–∏ —Å—Ç–∏–ª–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª style.css */

/* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã */
.theme-toggle {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 50px;
    padding: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-left: 20px;
    font-size: 1.2rem;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.theme-toggle:hover {
    transform: rotate(15deg) scale(1.1);
    box-shadow: 0 5px 15px var(--shadow-color);
    background: var(--accent-primary);
}
/* Dropdown –º–µ–Ω—é */
.nav-dropdown {
    position: relative;
    display: inline-block;
}



/* –ò–∫–æ–Ω–∫–∏ */
.nav-icons {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.discord-btn {
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 0.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
}

.discord-btn:hover {
    background: #5865F2;
    border-color: #5865F2;
    transform: scale(1.05);
}

.discord-icon {
    width: 20px;
    height: 20px;
    filter: invert(1);
}

[data-theme="light"] .discord-icon {
    filter: invert(0);
}

.discord-btn:hover .discord-icon {
    filter: invert(1);
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è dropdown */
@media (max-width: 768px) {
    .nav-menu {
        gap: 1rem;
    }
    
    .dropdown-content {
        position: fixed;
        top: 80px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 300px;
    }
    
    .nav-icons {
        gap: 0.5rem;
    }
    
    .discord-btn {
        width: 36px;
        height: 36px;
    }
    
    .discord-icon {
        width: 18px;
        height: 18px;
    }
}
/* –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
.detailed-stats {
    margin-top: 3rem;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    grid-column: 1 / -1;
}

.stat-item-large {
    background: var(--bg-card);
    padding: 1.5rem;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    text-align: center;
    box-shadow: var(--card-shadow);
}

.stat-item-large .stat-value {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 0.5rem;
    color: var(--accent-primary);
}

.stat-item-large .stat-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∏ –ª—É—á—à–∏—Ö */
.top-player-card,
.top-demon-card,
.popular-demon-card {
    background: var(--bg-card);
    padding: 1.5rem;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    box-shadow: var(--card-shadow);
}

.top-player-card {
    border-left: 4px solid var(--accent-rules);
}

.top-demon-card {
    border-left: 4px solid var(--accent-primary);
}

.popular-demon-card {
    border-left: 4px solid var(--accent-secondary);
}

.top-player-card h3,
.top-demon-card h3,
.popular-demon-card h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
    font-size: 1.1rem;
    font-weight: 600;
}

.player-info,
.demon-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.player-name,
.demon-name {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 1.1rem;
}

.player-points,
.demon-points,
.completion-count {
    color: var(--accent-primary);
    font-weight: 700;
}

.player-stats,
.demon-stats {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

/* –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è */
.recent-completions {
    margin-top: 3rem;
    background: var(--bg-card);
    padding: 1.5rem;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    box-shadow: var(--card-shadow);
}

.recent-completions h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
    font-size: 1.1rem;
    font-weight: 600;
}

.completions-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.completion-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem;
    background: var(--bg-secondary);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.completion-item:hover {
    transform: translateX(5px);
    background: var(--bg-primary);
}

.completion-item .player {
    font-weight: 600;
    color: var(--text-primary);
    min-width: 120px;
}

.completion-item .demon {
    color: var(--accent-primary);
    font-weight: 500;
    flex-grow: 1;
    text-align: center;
}

.completion-item .date {
    color: var(--text-secondary);
    font-size: 0.8rem;
    min-width: 100px;
    text-align: right;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
@media (max-width: 768px) {
    .detailed-stats {
        grid-template-columns: 1fr;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .stat-item-large .stat-value {
        font-size: 2rem;
    }
    
    .completion-item {
        flex-direction: column;
        gap: 0.5rem;
        text-align: center;
    }
    
    .completion-item .player,
    .completion-item .demon,
    .completion-item .date {
        min-width: auto;
        text-align: center;
    }
    
    .player-info,
    .demon-info {
        flex-direction: column;
        gap: 0.5rem;
        text-align: center;
    }
}

@media (max-width: 480px) {
    .stat-item-large {
        padding: 1rem;
    }
    
    .top-player-card,
    .top-demon-card,
    .popular-demon-card {
        padding: 1rem;
    }
    
    .recent-completions {
        padding: 1rem;
    }
}

